<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CXX-Qt Documentation</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">ä»‹ç»</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="getting-started/index.html"><strong aria-hidden="true">1.</strong> å…¥é—¨</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting-started/1-qobjects-in-rust.html"><strong aria-hidden="true">1.1.</strong> Rust ä¸­çš„ QObjects</a></li><li class="chapter-item expanded "><a href="getting-started/2-our-first-cxx-qt-module.html"><strong aria-hidden="true">1.2.</strong> æˆ‘ä»¬ç¬¬ä¸€ä¸ª CXX-Qt æ¨¡å—</a></li><li class="chapter-item expanded "><a href="getting-started/3-exposing-to-qml.html"><strong aria-hidden="true">1.3.</strong> å¯¼å‡ºåˆ° QML</a></li><li class="chapter-item expanded "><a href="getting-started/4-qml-gui.html"><strong aria-hidden="true">1.4.</strong> åˆ›å»º QML GUI</a></li><li class="chapter-item expanded "><a href="getting-started/5-cmake-integration.html"><strong aria-hidden="true">1.5.</strong> ç”¨ CMake æ„å»º</a></li></ol></li><li class="chapter-item expanded "><a href="qobject/index.html"><strong aria-hidden="true">2.</strong> QObject</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="qobject/macro.html"><strong aria-hidden="true">2.1.</strong> å®</a></li><li class="chapter-item expanded "><a href="qobject/data_struct.html"><strong aria-hidden="true">2.2.</strong> Data ç»“æ„ä½“</a></li><li class="chapter-item expanded "><a href="qobject/rustobj_struct.html"><strong aria-hidden="true">2.3.</strong> RustObj ç»“æ„ä½“</a></li><li class="chapter-item expanded "><a href="qobject/cpp_object.html"><strong aria-hidden="true">2.4.</strong> Cpp å¯¹è±¡</a></li><li class="chapter-item expanded "><a href="qobject/signals_enum.html"><strong aria-hidden="true">2.5.</strong> Signals æšä¸¾</a></li><li class="chapter-item expanded "><a href="qobject/handlers.html"><strong aria-hidden="true">2.6.</strong> Handlers</a></li></ol></li><li class="chapter-item expanded "><a href="concepts/index.html"><strong aria-hidden="true">3.</strong> æ¦‚å¿µ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts/bridge.html"><strong aria-hidden="true">3.1.</strong> Bridge</a></li><li class="chapter-item expanded "><a href="concepts/qt.html"><strong aria-hidden="true">3.2.</strong> Qt</a></li><li class="chapter-item expanded "><a href="concepts/types.html"><strong aria-hidden="true">3.3.</strong> ç±»å‹</a></li><li class="chapter-item expanded "><a href="concepts/build_rs_and_cargo.html"><strong aria-hidden="true">3.4.</strong> Build.rs å’Œ Cargo.toml</a></li><li class="chapter-item expanded "><a href="concepts/cmake.html"><strong aria-hidden="true">3.5.</strong> CMake é›†æˆ</a></li><li class="chapter-item expanded "><a href="concepts/register_types.html"><strong aria-hidden="true">3.6.</strong> æ³¨å†Œç±»å‹</a></li><li class="chapter-item expanded "><a href="concepts/qqmlextensionplugin.html"><strong aria-hidden="true">3.7.</strong> QQmlExtensionPlugin</a></li><li class="chapter-item expanded "><a href="concepts/threading.html"><strong aria-hidden="true">3.8.</strong> çº¿ç¨‹</a></li><li class="chapter-item expanded "><a href="concepts/nested_objects.html"><strong aria-hidden="true">3.9.</strong> åµŒå¥—å¯¹è±¡</a></li></ol></li><li class="chapter-item expanded "><a href="internal/index.html"><strong aria-hidden="true">4.</strong> å†…éƒ¨å‰–æ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="internal/build.html"><strong aria-hidden="true">4.1.</strong> æ„å»º</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CXX-Qt Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="cxx"><a class="header" href="#cxx">CXX</a></h1>
<p>è¿™åº“ä¸º Qt ä»£ç å’Œ Rust ä»£ç ä¹‹é—´çš„èåˆæä¾›äº†ä¸€ç§å®‰å…¨çš„æœºåˆ¶ï¼Œè¿™ä¸åŒäºå¸¸è§„çš„ Rust Qt ç»‘å®šã€‚</p>
<p>æˆ‘ä»¬æ‰¿è®¤ Qt ä»£ç å’Œ Rust ä»£ç æœ‰ä¸åŒçš„é£æ ¼ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥è¿›è¡Œå°è£…ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ <a href="https://cxx.rs/">CXX</a> æ¥<a href="./concepts/bridge.html">æ¡¥æ¥</a>ï¼Œè€Œä¸æ˜¯ä¸€å¯¹ä¸€çš„ç»‘å®šï¼Œè¿™æ ·å¯ä»¥è®©æˆ‘ä»¬ç¼–å†™å¸¸è§„çš„ Qt/Rust ä»£ç ã€‚</p>
<p>æˆ‘ä»¬è§‰å¾—è¿™æ¯”å¸¸è§„çš„ç»‘å®šæ›´å¼ºå¤§ï¼Œå› ä¸ºè¿™åœ¨ Qt å’Œ Rust ä¹‹é—´æä¾›äº†å®‰å…¨çš„ API å’Œå®‰å…¨çš„<a href="./concepts/threading.html">å¤šçº¿ç¨‹</a>ã€‚</p>
<p>ä¸ºäº†ä½¿ Qt å’Œ Rust ä»£ç è¿›è¡Œèåˆï¼Œæˆ‘ä»¬ä¸º Rust æä¾›äº†å¸¸è§çš„ <a href="./concepts/types.html">Qt ç±»å‹</a>ï¼Œå¹¶æä¾›äº†è®©æˆ‘ä»¬è·¨è¶Šæ¡¥æ¢ä½¿ç”¨å¸¸ç”¨çš„ <a href="./concepts/qt.html">Qt é£æ ¼</a>çš„æ–¹æ³•ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡ä½¿ç”¨å®å’Œä»£ç ç”Ÿæˆï¼Œå¼€å‘è€…å†™äº†ä¸€ä¸ªå¸¦æœ‰ CXX-Qt å®æ ‡è®°çš„ <code>QObject</code>ã€‚ç„¶å CXX-Qt ç”Ÿæˆ C++ å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨å®å±•å¼€æ¥å®šä¹‰ <a href="https://cxx.rs/">CXX</a> æ¡¥ï¼Œä»¥è¾¾åˆ° C++ å’Œ Rust ä¹‹é—´äº¤äº’çš„ç›®çš„ã€‚</p>
<div style="background-color: white; padding: 1rem; text-align: center;">
<p><img src="./images/overview_abstract.svg" alt="Overview of CXX-Qt concept" /></p>
</div>
<p>å¦‚æœæ‚¨æ˜¯ CXX-Qt çš„æ–°æ‰‹ï¼Œå»ºè®®è®¿é—®æˆ‘ä»¬çš„<a href="./getting-started/index.html">å…¥é—¨æŒ‡å—</a>ã€‚</p>
<p>è¦è·å–æœ‰å…³ CXX-Qt ä¸­çš„ QObject æœ‰å“ªäº›ç‰¹æ€§ï¼Œè¯·å‚é˜… <a href="./qobject/index.html">QObject ç« èŠ‚</a>ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£æ·±å…¥äº†è§£ CXX-Qt çš„ç›¸å…³æ¦‚å¿µï¼Œè¯·å‚é˜…<a href="./concepts/index.html">æ¦‚å¿µç« èŠ‚</a>ï¼Œå…¶ä¸­è¯¦ç»†è§£é‡Šäº† CXX-Qt å¼•å…¥çš„ä¸€äº›æ¦‚å¿µã€‚</p>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä»…æ”¯æŒ 64 ä½ x86 Linux çš„æ“ä½œç³»ç»Ÿï¼Œä½†æˆ‘ä»¬è®¡åˆ’åœ¨æœªæ¥æ·»åŠ  arm 64 ä½æ“ä½œç³»ç»Ÿä»¥åŠ macOS å’Œ Windows æ“ä½œç³»ç»Ÿçš„æ”¯æŒã€‚(è¯‘æ³¨ï¼šäº²æµ‹åœ¨ Windowsã€MacOSã€Linux ä¸Šå‡å¯ä»¥ä½¿ç”¨ï¼Œä¼°è®¡æ˜¯æ–‡æ¡£è¿˜æ²¡æœ‰åŠæ—¶æ›´æ–°)</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="cxx-qt---å…¥é—¨"><a class="header" href="#cxx-qt---å…¥é—¨">CXX-Qt - å…¥é—¨</a></h1>
<p>ä¸å…¶ä»– Qt-Rust ç»‘å®šç›¸æ¯”ï¼ŒCXX-Qt çš„ç›®æ ‡ä¸æ˜¯ç®€å•åœ°å°† Qt å‡½æ•°æš´éœ²ç»™ Rustï¼Œè€Œæ˜¯å°† Rust å®Œå…¨èåˆåˆ° Qt ç”Ÿæ€ç³»ç»Ÿä¸­ã€‚</p>
<p>åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªè™½å°ä½†å®Œæ•´çš„ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹ä½¿ç”¨ CXX-Qt åœ¨ Rust ä¸­åˆ›å»ºæ‚¨è‡ªå·±çš„ QObjectï¼Œå¹¶ä¸å°å‹çš„ QML GUI é›†æˆã€‚ç”±äº CXX-Qt æ—¨åœ¨å°† Rust é›†æˆåˆ°ç°æœ‰çš„ Qt ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œå› æ­¤åœ¨é˜…è¯»æœ¬æŒ‡å—å‰ï¼Œæ‚¨åº”è¯¥å…·å¤‡ Qt å’Œ QML çš„åŸºç¡€çŸ¥è¯†ã€‚å¦‚æœæ‚¨è¿˜ä¸ç†Ÿæ‚‰ Qt/QMLï¼Œè¯·åˆ†åˆ«æŸ¥çœ‹ <a href="https://doc.qt.io/qt-5/gettingstarted.html">Qt Getting started guide</a> æˆ– <a href="https://doc.qt.io/qt-5/qmlapplications.html">QML intro</a>ã€‚</p>
<p>åœ¨æœ¬å…¥é—¨æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆäº†è§£ CXX-Qt å¦‚ä½•ä¸ Qt çš„å¯¹è±¡ç³»ç»Ÿé›†æˆå¹¶ä¸”åœ¨ <a href="getting-started/./1-qobjects-in-rust.html">Rust ä¸­å®šä¹‰ QObject</a> çš„ã€‚ç„¶åæˆ‘ä»¬ç›´æ¥é€šè¿‡å®è·µï¼Œå¹¶å°†æˆ‘ä»¬ç¬¬ä¸€ä¸ª <a href="getting-started/./2-our-first-cxx-qt-module.html">QObject å®šä¹‰ä¸º Rust æ¨¡å—</a>ã€‚å½“æˆ‘ä»¬å®Œæˆåï¼Œå°†<a href="getting-started/./3-exposing-to-qml.html">å®šä¹‰å¥½çš„ QObject æš´éœ²ç»™ QML</a>ã€‚ç„¶å<a href="getting-started/./4-qml-gui.html">ä½¿ç”¨ QML ç¼–å†™æˆ‘ä»¬çš„ GUI</a>ã€‚æœ€åï¼Œ<a href="getting-started/./5-cmake-integration.html">é€šè¿‡ CMake å°†æˆ‘ä»¬çš„ä»£ç èåˆ</a>ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ„å»ºå¹¶è¿è¡Œã€‚</p>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬ä»…æ”¯æŒ 64 ä½ x86 Linux çš„æ“ä½œç³»ç»Ÿï¼Œä½†æˆ‘ä»¬è®¡åˆ’åœ¨æœªæ¥æ·»åŠ  arm 64 ä½æ“ä½œç³»ç»Ÿä»¥åŠ macOS å’Œ Windows æ“ä½œç³»ç»Ÿçš„æ”¯æŒã€‚(è¯‘æ³¨ï¼šäº²æµ‹åœ¨ Windowsã€MacOSã€Linux ä¸Šå‡å¯ä»¥ä½¿ç”¨ï¼Œä¼°è®¡æ˜¯æ–‡æ¡£è¿˜æ²¡æœ‰åŠæ—¶æ›´æ–°)</p>
<p>åºŸè¯å°‘è¯´ï¼Œæˆ‘ä»¬<a href="getting-started/./1-qobjects-in-rust.html">å¼€å§‹</a>å§</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="rust-ä¸­çš„-qobjects"><a class="header" href="#rust-ä¸­çš„-qobjects">Rust ä¸­çš„ QObjects</a></h1>
<blockquote>
<p>ç”¨æ­£ç¡®å·¥å…·åšæ­£ç¡®äº‹ã€‚</p>
</blockquote>
<blockquote>
<p>å¦‚æœä½ åªæœ‰ä¸€æŠŠé”¤å­ï¼Œé‚£ä¹ˆæ¯ä¸ªé—®é¢˜çœ‹èµ·æ¥éƒ½åƒé’‰å­ã€‚</p>
</blockquote>
<blockquote>
<p>ä¸è¦ç”¨åˆ€æ¥ä½œæªæˆ˜ã€‚</p>
</blockquote>
<p>è¿™æ ·çš„æ„è§æœ‰å¾ˆå¤šã€‚æˆ‘ä»¬ä½¿ç”¨ CXX-Qt çš„ç›®æ ‡æ˜¯ï¼Œåœ¨æ„å»ºç°ä»£ GUI åº”ç”¨ç¨‹åºæ—¶ï¼Œè®©ä½¿ç”¨æ­£ç¡®çš„å·¥å…·æ¥åšä»»ä½•æœ‰å¿…è¦çš„å·¥ä½œæˆä¸ºå¯èƒ½ã€‚</p>
<p>é‚£ä¹ˆå¯¹äºå¸¸è§„çš„ Qt åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬çš„å·¥å…·ç®±ä¸­æœ‰ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>QML - ä¸€ç§å£°æ˜æ€§ã€çµæ´»ã€åŠ¨æ€ç±»å‹ã€è§£é‡Šæ€§è¯­è¨€ï¼Œæ—¨åœ¨å®šä¹‰é«˜å“åº”ä¸”ç¾è§‚çš„ GUI å¸ƒå±€å’Œå°éƒ¨ä»¶æ—¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿè¿­ä»£æ„å»ºã€‚</li>
<li>C++ - Qt çš„ä¼ ç»Ÿåç«¯, ä¸€ç§å…·æœ‰å¼ºå¤§ç±»å‹ç³»ç»Ÿçš„å¿«é€Ÿã€ä½çº§è¯­è¨€ã€‚C++ æä¾›äº†ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿã€è®¸å¤š Qt ç‰¹å®šçš„åº“å’Œè£¸æœºæ€§èƒ½ã€‚ä½¿ç”¨ C++ çš„ä»£ä»·æ˜¯å¼€å‘é€Ÿåº¦æ…¢ï¼Œéå¸¸å®¹æ˜“å‡ºé”™ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜é—®é¢˜ï¼Œè¿™ä¼šä½¿æ‚¨çš„åº”ç”¨ç¨‹åºç«‹å³å´©æºƒå¹¶å¯¼è‡´å®‰å…¨é—®é¢˜</li>
</ul>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ²¡æœ‰ä¸€ç§åç«¯è¯­è¨€å¯ä»¥è®©æˆ‘ä»¬æ‘†è„± C++ çš„é—®é¢˜ï¼Œå¹¶ä¸ºæˆ‘ä»¬æä¾›ä¸€ç§å¿«é€Ÿç¼–å†™åç«¯ä»£ç çš„å®‰å…¨æ–¹æ³•ã€‚è¿™å½“ç„¶æ˜¯ Rust çš„ç”¨æ­¦ä¹‹åœ°ã€‚è™½ç„¶ Rust æ²¡æœ‰é‚£ä¹ˆä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿï¼Œä½†å®ƒé€šå¸¸æ¯” C++ å¼€å‘æ›´å¿«ï¼Œå…·æœ‰ç®€å•çš„ä¾èµ–ç®¡ç†ï¼Œæœ€é‡è¦çš„æ˜¯å®‰å…¨çš„å†…å­˜è®¿é—®ã€‚å› æ­¤ï¼Œå®ƒæ˜¯æ›¿ä»£ C++ æ¥ç¼–å†™ä¸º GUI æä¾›æ•°æ®çš„åç«¯ä¸šåŠ¡é€»è¾‘ä»£ç çš„ç†æƒ³å€™é€‰è€…ã€‚</p>
<p>ä½†æ˜¯ï¼ŒC++ å’Œ QML åœ¨ Qt åº”ç”¨ç¨‹åºä¸­ä»ç„¶å æœ‰ä¸€å¸­ä¹‹åœ°ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼ŒRustã€C++ å’Œ QML éƒ½åº”è¯¥èƒ½å¤Ÿç›¸äº’è¡¥å……ã€‚CXX-Qt æ—¨åœ¨é€šè¿‡ä½¿ç”¨ <a href="https://doc.qt.io/qt-5/metaobjects.html">Qt å…ƒå¯¹è±¡ç³»ç»Ÿ</a>ï¼Œè½»æ¾åœ°å°†æ‰€æœ‰ä¸‰ç§è¯­è¨€ç›¸äº’èåˆã€‚</p>
<p>Qt çš„è®¾è®¡æœ¬è´¨ä¸Šæ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå¯¹äº C++ å’Œ QML ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å› æ­¤ï¼Œä¸ºäº†æ›´å¥½åœ°ä¸ Qt èåˆï¼ŒRust éœ€è¦èƒ½å¤Ÿä½¿ç”¨è‡ªå·±çš„ QObject å­ç±»å’Œå®ä¾‹æ¥æ‰©å±• Qt å¯¹è±¡ç³»ç»Ÿã€‚è¿™æ­£æ˜¯ CXX-Qt åšçš„äº‹æƒ…ã€‚</p>
<p>ç”±äº Rust ä¸æä¾›å…·æœ‰ç»§æ‰¿å’Œå¤šæ€æ€§çš„ç±»ï¼Œå› æ­¤ CXX-Qt åœ¨å®šä¹‰æ–°çš„ QObject å­ç±»æ—¶ä½¿ç”¨äº† Rust æ¨¡å—ã€‚</p>
<p>è¿™äº› CXX-Qt æ¨¡å—ç”±å¤šä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>ä¸€ä¸ª <code>Data</code> ç»“æ„ä½“
<ul>
<li>å®šä¹‰å“ªäº›å±æ€§å°†åœ¨ QObject å­ç±»ä¸­.</li>
<li>éœ€è¦å®ç° <code>Default</code> trait.</li>
<li>è¿™äº›æ•°æ®å°†ä½œä¸º CXX-Qt ç”Ÿæˆçš„ C++ å­ç±»ä¸­çš„å±æ€§å­˜åœ¨ã€‚</li>
</ul>
</li>
<li>ä¸€ä¸ª <code>RustObj</code> ç»“æ„ä½“
<ul>
<li>ä¸€ä¸ªæ™®é€šçš„ Rust ç»“æ„ã€‚</li>
<li>æ¯ä¸ªç±»å®ä¾‹åˆ›å»ºä¸€ä¸ªç»“æ„å®ä¾‹ã€‚</li>
<li>åŒ…å«ä»»ä½• Rust-only çš„æ•°æ®ã€‚</li>
<li>éœ€è¦å®ç° <code>Default</code> trait.</li>
</ul>
</li>
<li><code>RustObj</code> ç»“æ„ä½“çš„ <code>impl</code> (å¯é€‰):
<ul>
<li>åŒ…å«ä»»ä½• Rust ä»£ç ã€‚</li>
<li>æ ‡æœ‰ <code>#[invokable]</code> çš„å‡½æ•°å¯ä»¥åœ¨ QML å’Œ C++ ä¸­è°ƒç”¨ã€‚</li>
</ul>
</li>
</ul>
<!-- TODO: Add Signals enum, once #67 lands -->
<p>ç„¶åï¼ŒCXX-Qt ä¼šå°†è¿™ä¸ª Rust æ¨¡å—æ‰©å±•ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼š</p>
<ul>
<li>ä¸æ¨¡å—åŒåçš„ C++ QObject å­ç±»</li>
<li>Rust ç»“æ„ä½“ <code>RustObj</code></li>
</ul>
<div style="background-color: white; padding: 1rem; text-align: center;">
<p><img src="getting-started/../images/overview_abstract.svg" alt="Overview of CXX-Qt module generation" /></p>
</div>
<p>CXX-Qt è¿˜ä½¿ç”¨ <a href="https://cxx.rs/">CXX åº“</a>ç”Ÿæˆ C++ QObject å­ç±»å’Œ <code>RustObj</code> ç»“æ„ä½“äº¤äº’æ‰€éœ€çš„ä»£ç ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="getting-started/../concepts/bridge.html">æ¦‚å¿µï¼šæ¡¥æ¥</a>é¡µé¢ã€‚æ­¤å¤–ï¼ŒCXX-Qt ä¸ºæˆ‘ä»¬å°è£…äº†ä¸€äº› Qt ç±»å‹ï¼Œå› æ­¤ Rust å¯ä»¥è½»æ¾åœ°ä½¿ç”¨å®ƒä»¬ã€‚æœ‰å…³å¯ç”¨ç±»å‹çš„åˆ—è¡¨ï¼Œè¯·å‚é˜…<a href="getting-started/../concepts/types.html">æ¦‚å¿µï¼šQt ç±»å‹</a>é¡µé¢ã€‚</p>
<p>è¿™é‡Œé‡è¦çš„ä¸€ç‚¹æ˜¯ CXX-Qt ç”Ÿæˆçš„ä»»ä½•å­ç±»çš„å¯¹å¶æ€§ã€‚è¿™äº›ç±»ç”±çº¯ç²¹å­˜åœ¨äº C++ ç«¯çš„å®é™… QObject å­ç±»å®ä¾‹ä»¥åŠ <code>RustObj</code> ç»“æ„ä½“çš„å®ä¾‹ç»„æˆã€‚å› æ­¤ï¼Œç”Ÿå‘½å‘¨æœŸå’Œ GUI æ•°æ®ç”± C++ ç«¯çš„ QObject å®ä¾‹ç®¡ç†ã€‚é€šå¸¸è¿™å°†ç”± QML å®ä¾‹åŒ–ï¼Œå¹¶ä¸”ç”Ÿå‘½å‘¨æœŸå°†ç›´æ¥ä¸ç›¸åº”çš„ QML å°éƒ¨ä»¶ç›¸å…³è”ã€‚ä»»ä½•å£°æ˜åœ¨ <code>Data</code> ç»“æ„ä½“ä¸­çš„å±æ€§éƒ½å°†å­˜å‚¨ä¸º C++ QObject çš„æˆå‘˜ã€‚</p>
<p>ç„¶è€Œï¼Œç”Ÿæˆçš„ QObject å­ç±»å°†éµå¾ª <code>RustObj</code> ç»“æ„ä½“çš„ä»»ä½•è¡Œä¸ºï¼Œç„¶ååœ¨ Rust ä¸­å®šä¹‰ã€‚è¯¥ <code>RustObj</code> ç»“æ„ä½“å¯ä»¥å¯¼å‡ºæ ‡è®°ä¸º <code>#[invokable]</code> çš„å‡½æ•°ï¼Œè¿™å°†åœ¨ C++ ç«¯ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ç›´æ¥è°ƒç”¨é€‚å½“çš„ Rust æ–¹æ³•ã€‚è¿™äº› Rust æ–¹æ³•å¯ä»¥é€šè¿‡åä¸º <code>CppObj</code> çš„å°è£…å¼•ç”¨ C++ å¯¹è±¡çš„æˆå‘˜ï¼Œå› æ­¤ Rust ä»£ç å¯ä»¥ä¿®æ”¹å®ƒä»¬ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†è¿™ä¸€åˆ‡çš„ç†è®ºï¼Œè®©æˆ‘ä»¬å¼€å§‹ç¼–å†™<a href="getting-started/./2-our-first-cxx-qt-module.html">æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª CXX-Qt æ¨¡å—</a>å§ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª-cxx-qt-æ¨¡å—"><a class="header" href="#æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª-cxx-qt-æ¨¡å—">æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª CXX-Qt æ¨¡å—</a></h1>
<p>ä¸æ‰€æœ‰ Rust ä¸€æ ·ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ª cargo é¡¹ç›®ã€‚</p>
<pre><code class="language-bash">cargo new --lib qml-minimal
</code></pre>
<p>æ³¨æ„æ­¤å¤„çš„ <code>--lib</code> é€‰é¡¹ã€‚æˆ‘ä»¬åœ¨ Rust ä¸­åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé™æ€åº“ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚å½“æˆ‘ä»¬<a href="getting-started/./5-cmake-integration.html">å°† Rust é¡¹ç›®ä¸ CMake é›†æˆ</a>æ—¶ï¼Œå†è®¨è®ºè¿™æ–¹é¢çš„ç»†èŠ‚ã€‚</p>
<p>å¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ï¼Œè¦å®šä¹‰ä¸€ä¸ªæ–°çš„ QObject å­ç±»ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Rust æ¨¡å—ã€‚æ‰€ä»¥è®©æˆ‘ä»¬è¿›å…¥ <code>src/lib.rs</code> æ–‡ä»¶ã€‚æˆ‘ä»¬å°†ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œç›´åˆ°å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<pre><code class="language-rust ignore">use cxx_qt::make_qobject;

#[make_qobject]
mod my_object {

    #[derive(Default)]
    pub struct Data {
        number: i32,
        string: String,
    }

    #[derive(Default)]
    struct RustObj;

    impl RustObj {
        #[invokable]
        fn increment_number(&amp;self, cpp: &amp;mut CppObj) {
            cpp.set_number(cpp.number() + 1);
        }

        #[invokable]
        fn say_hi(&amp;self, string: &amp;str, number: i32) {
            println!(
                &quot;Hi from Rust! String is '{}' and number is {}&quot;,
                string, number
            );
        }
    }
}
</code></pre>
<p>æœ‰å¾ˆå¤šä¸œè¥¿ä¸œè¥¿è¦å†™ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ã€‚ä»æ¨¡å—å®šä¹‰å¼€å§‹ï¼š</p>
<pre><code class="language-rust ignore">use cxx_qt::make_qobject;

#[make_qobject]
mod my_object {
</code></pre>
<p>å› ä¸ºæˆ‘ä»¬å°† <code>#[make_qobject]</code> å®æ·»åŠ åˆ°æ¨¡å—å®šä¹‰ä¸­ï¼ŒCXX-Qt ä¼šä»è¿™ä¸ªæ¨¡å—åˆ›å»ºä¸€ä¸ªæ–°çš„ QObject å­ç±»ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ–°çš„ QObject å­ç±»å°†å‘½åä¸º <code>MyObject</code>ï¼Œå› ä¸º CXX-Qt ä¼šè‡ªåŠ¨å°† Rust çš„ snake_case è½¬æ¢ä¸º Qt é»˜è®¤çš„ PascalCaseã€‚CXX-Qt ä½¿ç”¨ Rust å’Œ C++ çš„ä»£ç é£æ ¼ï¼Œå› æ­¤å®ƒä¼šå°½æœ€å¤§çš„åŠªåŠ›ä¿æŒ C++ å’Œ Rust çš„æ ·å¼ä¸€è‡´ã€‚</p>
<p>ä¸ºäº†ä½¿ <code>#[make_qobject]</code> å®èµ·ä½œç”¨ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å®šä¹‰å°†å­˜åœ¨äºæ–° C++ å¯¹è±¡ä¸­çš„æ•°æ®ã€‚è¿™æ˜¯é€šè¿‡ <code>Data</code> ç»“æ„ä½“æ¥å®Œæˆçš„ï¼š</p>
<pre><code class="language-rust ignore">    #[derive(Default)]
    pub struct Data {
        number: i32,
        string: String,
    }
</code></pre>
<p>è¿™æ„å‘³ç€æ–°åˆ›å»ºçš„ QObject å­ç±»å°†æœ‰ä¸¤ä¸ªå±æ€§ä½œä¸ºæˆå‘˜ï¼š<code>number</code> å’Œ <code>string</code>. å¯¹äºåŒ…å«å¤šä¸ªå•è¯çš„åç§°ï¼Œä¾‹å¦‚ <code>my_number</code>ï¼ŒCXX-Qt å°†å†æ¬¡æ‰§è¡Œ snake_case åˆ° camelCase çš„è½¬æ¢ï¼Œä»¥ç¬¦åˆ C++/QML å‘½åçº¦å®šã€‚</p>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„æ•°æ®ç±»å‹æ˜¯æ™®é€šçš„ Rust æ•°æ®ç±»å‹ã€‚CXX-Qt ä¼šè‡ªåŠ¨å°†è¿™äº›ç±»å‹è½¬æ¢ä¸ºå®ƒä»¬çš„ C++/Qt ç­‰ä»·ç±»å‹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™æ„å‘³ç€ï¼š</p>
<ul>
<li><code>number: i32</code> -&gt; <code>int number</code></li>
<li><code>string: String</code> -&gt; <code>QString string</code><br />
æœ‰å…³æ›´å¤šå¯ä»¥ç±»å‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="getting-started/../concepts/types.html">Qt ç±»å‹é¡µé¢</a>ã€‚</li>
</ul>
<p>ä½ å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†è¿™é‡Œçš„ <code>#[derive(Default)]</code>ã€‚ç›®å‰ Data ç»“æ„éœ€è¦å§‹ç»ˆæ˜¯é»˜è®¤å¯æ„é€ çš„ã€‚<code>Default</code> çš„å®ç°è¿”å›çš„æ•°æ®å°†è¢«è½¬æ¢ä¸ºé€‚å½“çš„ C++ ç±»å‹å¹¶åˆ†é…ç»™ä»»ä½•æ–°æ„é€ çš„ <code>MyObject</code> å®ä¾‹çš„å±æ€§ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸º Data æä¾›è‡ªå·±çš„ <code>Default</code> å®ç°ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»å®šä¹‰äº†å°†å­˜åœ¨äº C++ ç«¯çš„æ•°æ®ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Rust ç«¯ï¼š</p>
<pre><code class="language-rust ignore">    #[derive(Default)]
    struct RustObj;
</code></pre>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç©ºç»“æ„ä½“ã€‚ä½†æ˜¯ï¼Œ<code>RustObj</code> å¯ä»¥åŒ…å«ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚å®ƒä¸ä¼šè½¬æ¢ä¸º C++ ç±»ï¼Œå› æ­¤å®ƒä¸åƒ <code>Data</code> ç»“æ„ä½“é‚£æ ·åªå…è®¸åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨ä¸ Qt å…¼å®¹çš„æ•°æ®ç±»å‹ã€‚</p>
<p>è¿™é‡Œè¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯ <code>RustObj</code>, åƒ <code>Data</code> ç»“æ„ä½“é‚£æ ·å¿…é¡»å®ç° <code>Default</code> traitã€‚<code>MyObject</code> ç±»çš„æ¯ä¸ªå®ä¾‹éƒ½ä¼šä½¿ç”¨ <code>Default</code> trait æ¥è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå¯¹åº” <code>RustObj</code> çš„å®ä¾‹ã€‚</p>
<p>ä»…ä»…å› ä¸º <code>RustObj</code> ç»“æ„ä½“ä¸åŒ…å«ä»»ä½•æ•°æ®ï¼Œè¿™å¹¶ä¸æ„å‘³ç€å®ƒä¸æ˜¯æˆ‘ä»¬ <code>MyObject</code> ç±»çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚è¿™æ˜¯å› ä¸ºå®é™…ä¸Šé€šè¿‡å®ƒçš„ <code>impl</code> æ¥å®šä¹‰äº†æˆ‘ä»¬ç±»çš„è¡Œä¸ºï¼š</p>
<pre><code class="language-rust ignore">    impl RustObj {
        #[invokable]
        fn increment_number(&amp;self, cpp: &amp;mut CppObj) {
            cpp.set_number(cpp.number() + 1);
        }

        #[invokable]
        fn say_hi(&amp;self, string: &amp;str, number: i32) {
            println!(
                &quot;Hi from Rust! String is '{}' and number is {}&quot;,
                string, number
            );
        }
    }
</code></pre>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ–°å‡½æ•°ï¼š</p>
<ul>
<li><code>increment_number</code>
<ul>
<li>å¢åŠ  <code>MyObject</code> çš„ number çš„å€¼ã€‚</li>
<li>ç”±äº number ä½äº C++ ç«¯ï¼Œå®ƒä½¿ç”¨ç”± CXX-Qt ç”Ÿæˆçš„ <code>CppObj</code> å°è£…ï¼Œå¹¶ä¸ºæ¯ä¸ªå±æ€§æä¾›é€‚å½“çš„ setter å’Œ getter å‡½æ•°ã€‚</li>
<li>è¯¥åç§°åœ¨ C++ ä¸­ä¼šè½¬æ¢ä¸º <code>incrementNumber</code>ã€‚</li>
</ul>
</li>
<li><code>say_hello</code>
<ul>
<li>æ‰“å°ä¼ é€’è¿‡æ¥çš„ number å’Œ stringã€‚</li>
<li>è¯¥åç§°åœ¨ C++ ä¸­ä¼šè½¬æ¢ä¸º <code>sayHello</code>ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ ‡æœ‰ <code>#[invokable]</code> å®ï¼Œè¿™æ„å‘³ç€è¿™äº›å‡½æ•°å°†è¢«æ·»åŠ åˆ° C++ <code>MyObject</code> ä»£ç ä¸­ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥åœ¨ QML ä¸­è°ƒç”¨ã€‚</p>
<p>é™¤äº†ç”¨ <code>#[invokable]</code> å®æ ‡è®°çš„å‡½æ•°ä¹‹å¤–ï¼Œ<code>RustObj</code> impl åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ Rust ç»“æ„ä½“ implï¼Œå¯ä»¥åŒ…å«æ™®é€šçš„ Rust å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç…§å¸¸è°ƒç”¨ invokable å‡½æ•°ã€‚</p>
<p>å°±è¿™æ ·ã€‚æˆ‘ä»¬å·²ç»åœ¨ Rust ä¸­å®šä¹‰äº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª QObject å­ç±»ã€‚ä¸éš¾å§ï¼Ÿ</p>
<p>ç°åœ¨å¼€å§‹åœ¨ <a href="getting-started/./3-exposing-to-qml.html">Qt ä¸­ä½¿ç”¨å®ƒ</a>å§ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="æš´éœ²æˆ‘ä»¬çš„-qobject-å­ç±»ç»™-qml"><a class="header" href="#æš´éœ²æˆ‘ä»¬çš„-qobject-å­ç±»ç»™-qml">æš´éœ²æˆ‘ä»¬çš„ QObject å­ç±»ç»™ QML</a></h1>
<p>åœ¨<a href="getting-started/./2-our-first-cxx-qt-module.html">å®šä¹‰äº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª CXX-Qt æ¨¡å—</a>ä¹‹åï¼Œæˆ‘ä»¬å‡†å¤‡åˆ›å»º Qt åº”ç”¨ç¨‹åºå¹¶å°†æ–° <code>MyObject</code> ç±»å¯¼å‡ºç»™ QMLã€‚</p>
<p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨ <code>src</code> æ–‡ä»¶å¤¹ä¸­æ—è¾¹çš„ <code>lib.rs</code> æ–‡ä»¶æ·»åŠ ä¸€ä¸ª <code>main.cpp</code> æ–‡ä»¶ã€‚</p>
<pre><code class="language-cpp ignore">#include &lt;QtGui/QGuiApplication&gt;
#include &lt;QtQml/QQmlApplicationEngine&gt;

#include &quot;cxx-qt-gen/include/my_object.h&quot;

int
main(int argc, char* argv[])
{
  QGuiApplication app(argc, argv);

  QQmlApplicationEngine engine;

  const QUrl url(QStringLiteral(&quot;qrc:/main.qml&quot;));
  QObject::connect(
    &amp;engine,
    &amp;QQmlApplicationEngine::objectCreated,
    &amp;app,
    [url](QObject* obj, const QUrl&amp; objUrl) {
      if (!obj &amp;&amp; url == objUrl)
        QCoreApplication::exit(-1);
    },
    Qt::QueuedConnection);

  qmlRegisterType&lt;cxx_qt::my_object::MyObject&gt;(
    &quot;com.kdab.cxx_qt.demo&quot;, 1, 0, &quot;MyObject&quot;);

  engine.load(url);

  return app.exec();
}
</code></pre>
<p>è¿™ä¸ª C++ æ–‡ä»¶åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ Qt åº”ç”¨ç¨‹åºå¹¶æ‰§è¡Œå®ƒã€‚å¦‚æœæ‚¨å¯¹æ­¤ä¸ç†Ÿæ‚‰ï¼Œæˆ‘å»ºè®®æ‚¨æŸ¥çœ‹<a href="https://doc.qt.io/qt-5/gettingstarted.html">Qt documentation</a>ã€‚</p>
<p>ä¸æ™®é€šçš„ Qt åº”ç”¨ç¨‹åºç›¸æ¯”ï¼Œæœ‰ä¸¤ä¸ªæ˜¾ç€çš„å˜åŒ–ï¼š</p>
<pre><code class="language-cpp ignore">#include &quot;cxx-qt-gen/include/my_object.h&quot;
</code></pre>
<pre><code class="language-cpp ignore">  qmlRegisterType&lt;cxx_qt::my_object::MyObject&gt;(
    &quot;com.kdab.cxx_qt.demo&quot;, 1, 0, &quot;MyObject&quot;);
</code></pre>
<p>å¯¹äºæˆ‘ä»¬åœ¨ Rust ä¸­å®šä¹‰çš„æ¯ä¸ª QObject å­ç±»ï¼ŒCXX-Qt éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„ C++ ç±»ã€‚æ­¤ç±»åŒ…å«åœ¨ç¬¬ä¸€ä¸ªä»£ç ç‰‡æ®µä¸­ã€‚å®ƒä»¬å°†å§‹ç»ˆä½äº <code>cxx-qt-gen/include/</code> åŒ…å«è·¯å¾„ä¸­å¹¶ä½¿ç”¨ snake_case å‘½åçº¦å®šã€‚</p>
<p>ç„¶åç¬¬äºŒä¸ªä»£ç ç‰‡æ®µå°†è¯¥ç±»å¯¼å‡ºåˆ° QMLã€‚å°± Qt è€Œè¨€ï¼Œ<code>MyObject</code> ä¸ä»»ä½•å…¶ä»– QObject å­ç±»çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œè¿™æ­£æ˜¯å®ƒæ‰€å…³æ³¨çš„ã€‚è¿™é‡Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç±»æ˜¯åœ¨ <code>cxx_qt::my_object</code> å‘½åç©ºé—´ä¸­ç”Ÿæˆçš„ã€‚<code>my_object</code> æ˜¯æˆ‘ä»¬ä¹‹å‰å®šä¹‰ Rust æ¨¡å—çš„åç§°ã€‚</p>
<p>ç”±äºæˆ‘ä»¬å¸Œæœ›åœ¨<a href="https://doc.qt.io/qt-5/resources.html">Qt èµ„æºç³»ç»Ÿ</a>ä¸­åŒ…å«æˆ‘ä»¬çš„QML GUI <code>main.qml</code> æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬è¿˜å¿…é¡»åœ¨ <code>src</code> æ–‡ä»¶å¤¹ä¸­æ·»åŠ ä¸€ä¸ª <code>qml.qrc</code> æ–‡ä»¶ï¼š</p>
<pre><code class="language-qrc ignore">&lt;RCC version=&quot;1.0&quot;&gt;
    &lt;qresource prefix=&quot;/&quot;&gt;
        &lt;file&gt;main.qml&lt;/file&gt;
    &lt;/qresource&gt;
&lt;/RCC&gt;
</code></pre>
<p>å°±æ˜¯è¿™æ ·ã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥<a href="getting-started/./4-qml-gui.html">ä½¿ç”¨æ¥è‡ª QML çš„é…·ç‚«çš„æ–°ç±»</a>äº†ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="åˆ›å»ºæˆ‘ä»¬çš„-qml-gui"><a class="header" href="#åˆ›å»ºæˆ‘ä»¬çš„-qml-gui">åˆ›å»ºæˆ‘ä»¬çš„ QML GUI</a></h1>
<p>æ­£å¦‚ <a href="getting-started/./1-qobjects-in-rust.html">Rust ä¸­çš„ QObject</a> ä¸€ç« æ‰€è¿°ï¼Œæˆ‘ä»¬æ€»æ˜¯å¸Œæœ›ä½¿ç”¨â€œç”¨æ­£ç¡®çš„å·¥å…·æ¥åšæ­£ç¡®çš„äº‹â€ã€‚å¯¹äº Qt ä¸­çš„å°å‹ç°ä»£ GUIï¼Œè¿™ç»å¯¹æ„å‘³ç€ä½¿ç”¨ QMLã€‚å®ƒå…·æœ‰å¼ºå¤§ã€çµæ´»ã€å£°æ˜æ€§çš„ç‰¹ç‚¹ï¼Œå…è®¸æˆ‘ä»¬å¿«é€Ÿè¿­ä»£ã€‚</p>
<p>å› æ­¤ï¼Œè®©æˆ‘ä»¬åœ¨ <code>src</code> æ–‡ä»¶å¤¹ä¸­çš„å…¶ä»–ä¸¤ä¸ªæ–‡ä»¶æ—è¾¹æ·»åŠ ä¸€ä¸ª <code>main.qml</code> æ–‡ä»¶ï¼š</p>
<pre><code class="language-qml ignore">import QtQuick 2.12
import QtQuick.Controls 2.12
import QtQuick.Window 2.12

import com.kdab.cxx_qt.demo 1.0

Window {
    height: 480
    title: qsTr(&quot;Hello World&quot;)
    visible: true
    width: 640

    MyObject {
        id: myObject
        number: 1
        string: &quot;My String with my number: &quot; + myObject.number
    }

    Column {
        anchors.fill: parent
        anchors.margins: 10
        spacing: 10

        Label {
            text: &quot;Number: &quot; + myObject.number
        }

        Label {
            text: &quot;String: &quot; + myObject.string
        }

        Button {
            text: &quot;Increment Number&quot;

            onClicked: myObject.incrementNumber()
        }

        Button {
            text: &quot;Say Hi!&quot;

            onClicked: myObject.sayHi(myObject.string, myObject.number)
        }
    }
}
</code></pre>
<p>å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ QMLï¼Œæˆ‘å»ºè®®æ‚¨æŸ¥çœ‹<a href="https://doc.qt.io/qt-5/qmlapplications.html">Qt QML intro</a>ã€‚</p>
<p>è¿™æ®µä»£ç å°†åˆ›å»ºä¸€ä¸ªéå¸¸ç®€å•çš„ GUIï¼Œå®ƒç”±ä¸¤ä¸ª Label å’Œä¸¤ä¸ª Button ç»„æˆã€‚è¿™é‡Œé‡è¦çš„éƒ¨åˆ†æ˜¯ <code>MyObject</code> ç±»å‹çš„ä½¿ç”¨ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ç±»ç°åœ¨å¯ä»¥åœ¨ QML ä¸­ä½¿ç”¨ã€‚</p>
<p>ç”±äºå®ƒåªæ˜¯å¦ä¸€ä¸ª QObject å­ç±»ï¼Œå› æ­¤å¯ä»¥åœ¨ Qt å±æ€§ç»‘å®šç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œå°±åƒ <code>myObject.string</code> å’Œ <code>myObject.number</code>.</p>
<p>Label ç®€å•åœ°æ˜¾ç¤º <code>MyObject</code> ç±»ä¸­å®šä¹‰çš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ª Button ä¸ <code>MyObject</code> å®ä¾‹è¿›è¡Œäº¤äº’ã€‚æ­£å¦‚æ‚¨åœ¨æ­¤å¤„çœ‹åˆ°çš„ï¼ŒCXX-Qt å·²å°†å‡½æ•°åç§°çš„ snake_case è½¬æ¢ä¸º camelCase - <code>incrementNumber</code> å’Œ <code>sayHi</code>. è¿™æ · <code>MyObject</code>åœ¨ QML ä¸­ä¼¼ä¹ä¸æ˜¾ç¤ºè­¦å‘Šäº†ã€‚</p>
<p>è¿™é‡Œå†æ¬¡å¼ºè°ƒä¸€ç‚¹å¾ˆé‡è¦çš„ï¼Œ<code>MyObject</code> å®ƒåªæ˜¯å¦ä¸€ä¸ª QObject å­ç±»ï¼Œå¯ä»¥åƒä»»ä½•å…¶ä»– <code>QObject</code> å­ç±»ä¸€æ ·ä½¿ç”¨ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯å®šä¹‰çš„ä»»ä½•å¯è°ƒç”¨å‡½æ•°éƒ½æ˜¯åœ¨ Rust ä¸­å®šä¹‰çš„ï¼Œè€Œä¸æ˜¯åœ¨ C++ ä¸­å®šä¹‰çš„ã€‚å¯¹äº QML æ¥è¯´ï¼Œè¿™å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<p>OKï¼Œè®©æˆ‘ä»¬å¼€å§‹<a href="getting-started/./5-cmake-integration.html">æ„å»ºå’Œè¿è¡Œ</a>è¿™ä¸ªé¡¹ç›®å§ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="ä½¿ç”¨-cmake-æ„å»º"><a class="header" href="#ä½¿ç”¨-cmake-æ„å»º">ä½¿ç”¨ CMake æ„å»º</a></h1>
<pre><code class="language-diff ignore">- å…è´£å£°æ˜ï¼šCXX-Qt çš„ CMake é›†æˆä»å¤„äºå¼€å‘ä¸­ã€‚
- ç›®å‰çš„çŠ¶æ€ç¦»æœ€ä½³çŠ¶æ€è¿˜å¾ˆè¿œï¼Œæœªæ¥å¯èƒ½ä¼šæœ‰å¾ˆå¤šæ”¹å–„
- æ‰€ä»¥ä¸è¦å› ä¸ºè¿™ä¸€ç« çš„å†…å®¹è€Œæ°”é¦ã€‚
- æ¬¢è¿å¥‰çŒ®ã€‚
</code></pre>
<p>åœ¨å¼€å§‹ä½¿ç”¨ CMake æ„å»º Qt ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸º Cargo æ„å»ºåšå¥½å‡†å¤‡ã€‚å¦‚æœæ‚¨ä½¿ç”¨ <code>cargo new --lib</code> å‘½ä»¤ç”Ÿæˆäº†é¡¹ç›®ï¼Œæ‚¨ <code>Cargo.toml</code> æ–‡ä»¶å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<pre><code class="language-toml ignore">[package]
name = &quot;qml-minimal&quot;
version = &quot;0.1.0&quot;
edition = &quot;2021&quot;

[dependencies]
</code></pre>
<p>æˆ‘ä»¬é€æ­¥æ¥ï¼š</p>
<ul>
<li>æŒ‡ç¤º cargo åˆ›å»ºä¸€ä¸ªå…·æœ‰å®šä¹‰åç§°ï¼ˆâ€œrustâ€ï¼‰çš„é™æ€åº“ï¼Œä¾› CMake é“¾æ¥ã€‚</li>
<li>æ·»åŠ  <code>cxx</code>, <code>cxx-qt</code>, ä»¥åŠ <code>cxx-qt-lib</code> ä¾èµ–é¡¹ã€‚</li>
<li>æ·»åŠ  <code>clang-format</code> å’Œ <code>cxx-qt-build</code> ä½œä¸ºæ„å»ºä¾èµ–é¡¹ã€‚</li>
</ul>
<p>æœ€åï¼Œæ‚¨çš„ <code>Cargo.toml</code> åº”è¯¥çœ‹èµ·æ¥ä¸æ­¤ç±»ä¼¼ï¼ˆè¯·æ³¨æ„ï¼Œpathä¸éœ€è¦ä¾èµ–é¡¹ï¼‰ï¼š</p>
<pre><code class="language-toml ignore">[package]
name = &quot;qml-minimal&quot;
version = &quot;0.1.0&quot;
authors = [
  &quot;Andrew Hayzen &lt;andrew.hayzen@kdab.com&gt;&quot;,
  &quot;Gerhard de Clercq &lt;gerhard.declercq@kdab.com&gt;&quot;,
  &quot;Leon Matthes &lt;leon.matthes@kdab.com&gt;&quot;
]
edition = &quot;2018&quot;
license = &quot;MIT OR Apache-2.0&quot;

# This will instruct Cargo to create a static
# lib named &quot;rust&quot; which CMake can link against
[lib]
name = &quot;rust&quot;
crate-type = [&quot;staticlib&quot;]

[dependencies]
cxx = &quot;1.0&quot;
cxx-qt = { path = &quot;../../cxx-qt&quot; }
cxx-qt-lib = { path = &quot;../../cxx-qt-lib&quot; }

# cxx-qt needs to be able to generate C++ code at
# compile time, which is what cxx-qt-build is needed for.
# cxx-qt uses clang-format, if available, to format all
# C++ code in a consistent manner.
[build-dependencies]
clang-format = &quot;0.1&quot;
cxx-qt-build = { path = &quot;../../cxx-qt-build&quot; }

</code></pre>
<p>ç„¶åï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ <code>Cargo.toml</code> æ—è¾¹æ·»åŠ ä¸€ä¸ªåä¸º <code>build.rs</code> æ–‡ä»¶ï¼š</p>
<pre><code class="language-rust ignore">use clang_format::ClangFormatStyle;
use cxx_qt_build::CxxQtBuilder;

fn main() {
    CxxQtBuilder::new()
        .cpp_format(ClangFormatStyle::Mozilla)
        .file(&quot;src/lib.rs&quot;)
        .build();
}
</code></pre>
<p>è¿™å°±æ˜¯æ˜¯åœ¨ç¼–è¯‘æ—¶ä¸ºæˆ‘ä»¬ <code>MyObject</code> ç±»ç”Ÿæˆçš„ C++ ä»£ç ã€‚å®ƒå°†è¾“å‡ºæˆ‘ä»¬ä¹‹å‰åœ¨ <code>main.cpp</code> ä¸­åŒ…å«çš„ <code>cxx-qt-gen/include/my_object.h</code> æ–‡ä»¶ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œæ‰€æœ‰ä½¿ç”¨ <code>#[make_qobject]</code> å®çš„ Rust æºæ–‡ä»¶éƒ½éœ€è¦åŒ…å«åœ¨æ­¤è„šæœ¬ä¸­ï¼åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™éœ€è¦åŒ…å« <code>src/lib.rs</code> æ–‡ä»¶ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ç¼–å†™ <code>CMakeLists.txt</code> æ–‡ä»¶ï¼š</p>
<pre><code class="language-cmake ignore">cmake_minimum_required(VERSION 3.16)

project(example_qml_minimal)
set(APP_NAME ${PROJECT_NAME})

set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

find_package(QT NAMES Qt6 Qt5 COMPONENTS Core Gui Qml QuickControls2 QmlImportScanner REQUIRED)
find_package(Qt${QT_VERSION_MAJOR} COMPONENTS Core Gui Qml QuickControls2 QmlImportScanner REQUIRED)

include(CxxQt)

# Generate C++ code from Rust using Cargo in the current folder
cxx_qt_generate_cpp(GEN_SOURCES)

# Define our sources
set(
    CPP_SOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/src/main.cpp
)

set(
    RESOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/src/qml.qrc
)

# Define our executable with our C++ source, generated sources, and QML resource files
add_executable(${APP_NAME} &quot;${CPP_SOURCES}&quot; &quot;${GEN_SOURCES}&quot; &quot;${RESOURCES}&quot;)

# Include generated sources
cxx_qt_include(${APP_NAME})

# Link to generated rust library
cxx_qt_link_rustlib(${APP_NAME})

# Link to Qt in the normal way
target_link_libraries(${APP_NAME} PRIVATE
    Qt${QT_VERSION_MAJOR}::Core
    Qt${QT_VERSION_MAJOR}::Gui
    Qt${QT_VERSION_MAJOR}::Qml
    Qt${QT_VERSION_MAJOR}::QuickControls2
)
qt_import_qml_plugins(${APP_NAME})
</code></pre>
<p>è¿™çœ‹èµ·æ¥å¾ˆå¤šï¼Œä½†å®é™…ä¸Šå®ƒåªæ˜¯ä¸€ä¸ªç”¨äºæ„å»º Qt åº”ç”¨ç¨‹åºçš„ç›¸å½“æ ‡å‡†çš„ CMake æ–‡ä»¶ã€‚</p>
<p>è¿™é‡Œçš„åŒºåˆ«æ˜¯ï¼š</p>
<pre><code class="language-cmake ignore">include(CxxQt)

# Generate C++ code from Rust using Cargo in the current folder
cxx_qt_generate_cpp(GEN_SOURCES)
# Include generated sources
cxx_qt_include(${APP_NAME})

# Link to generated rust library
cxx_qt_link_rustlib(${APP_NAME})
</code></pre>
<p>å®ƒå°†æ‰§è¡Œä»£ç ç”Ÿæˆï¼Œå¹¶å°†å…¶åŒ…å«åˆ° C++ æ„å»ºä¸­ã€‚</p>
<p>è¿™é‡Œè¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼ŒCMake å¿…é¡»èƒ½å¤Ÿè§£æ <code>include(CxxQt)</code>. ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦å…‹éš† <a href="https://github.com/KDAB/cxx-qt/">CXX-Qt ä»£ç åº“</a>ï¼Œå¹¶å°† <code>CxxQt.cmake</code> æ–‡ä»¶æ·»åŠ åˆ° <code>CMAKE_MODULE_PATHCMake</code> å˜é‡ä¸­ã€‚å®ç°æ­¤ç›®çš„çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ CMake çš„ <code>-D</code> é€‰é¡¹ã€‚æœ‰å…³ä¸€äº›æ›¿ä»£æ–¹æ¡ˆï¼Œè¯·å‚é˜… <a href="getting-started/../concepts/cmake.html">CMake æ¦‚å¿µç« èŠ‚</a>ã€‚</p>
<p>å› æ­¤æ„å»ºæˆ‘ä»¬çš„é¡¹ç›®å¯ä»¥è¿™æ ·å®Œæˆï¼š</p>
<pre><code class="language-shell">$ mkdir build &amp;&amp; cd build
$ cmake -DCMAKE_MODULE_PATH=&quot;&lt;path-to-cxx-qt-repo&gt;/cmake&quot; ..
$ cmake --build .
</code></pre>
<p>å¦‚æœç”±äºæŸç§åŸå› å¤±è´¥ï¼Œè¯·æŸ¥çœ‹ <a href="https://github.com/KDAB/cxx-qt/tree/main/examples/qml_minimal"><code>examples/qml_minimal</code></a>æ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«å®Œæ•´ç¤ºä¾‹ä»£ç ã€‚</p>
<p>ç°åœ¨å¯ä»¥é…ç½®å’Œç¼–è¯‘æˆ‘ä»¬çš„é¡¹ç›®ã€‚å¦‚æœè¿™æˆåŠŸäº†ï¼Œä½ ç°åœ¨å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„å°é¡¹ç›®äº†ã€‚</p>
<pre><code class="language-shell">$ ./qml_minimal
</code></pre>
<p>æ‚¨ç°åœ¨åº”è¯¥çœ‹åˆ°æ˜¾ç¤ºæˆ‘ä»¬ <code>MyObject</code> çŠ¶æ€çš„ä¸¤ä¸ª Labelï¼Œä»¥åŠè°ƒç”¨æˆ‘ä»¬çš„ä¸¤ä¸ª Rust å‡½æ•°çš„ä¸¤ä¸ª Buttonã€‚</p>
<h2 id="æˆåŠŸ---"><a class="header" href="#æˆåŠŸ---">æˆåŠŸ   ğŸ¥³</a></h2>
<p>å¦‚éœ€è¿›ä¸€æ­¥é˜…è¯»ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹ <a href="getting-started/../qobject/index.html">QObject ç« èŠ‚</a>ï¼Œè¯¥ç« èŠ‚è¯¦ç»†ä»‹ç»äº† CXX-Qt å‘ QObject å­ç±»å…¬å¼€çš„æ‰€æœ‰å±æ€§ã€‚ä¹Ÿå¯ä»¥çœ‹<a href="getting-started/../concepts/index.html">æ¦‚å¿µç« èŠ‚</a>ï¼Œå®ƒè§£é‡Šäº† CXX-Qt çš„åº•å±‚æ¦‚å¿µã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="qobject"><a class="header" href="#qobject">QObject</a></h1>
<p>ä¸€ä¸ª QObject ç”±ä»¥ä¸‹éƒ¨åˆ†æ„æˆ</p>
<ul>
<li><a href="qobject/./macro.html">æ¨¡å—ä¸Šçš„å®</a></li>
<li><a href="qobject/./data_struct.html">å®šä¹‰å±æ€§çš„ Data ç»“æ„ä½“</a></li>
<li><a href="qobject/./rustobj_struct.html">å®šä¹‰å¯è°ƒç”¨å‡½æ•°çš„ RustObj</a></li>
<li><a href="qobject/./cpp_object.html">Cpp å¯¹è±¡å°è£…</a></li>
<li><a href="qobject/./signals_enum.html">ç”¨äºå®šä¹‰ä¿¡å·çš„ Signals æšä¸¾</a></li>
<li><a href="qobject/./handlers.html">RustObj ä¸Šçš„ handlersï¼Œç”¨äºå¤„ç† Qt çº¿ç¨‹ä¸Šçš„äº‹ä»¶</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="å®"><a class="header" href="#å®">å®</a></h1>
<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼ˆå®ƒæˆä¸ºæˆ‘ä»¬çš„ Qt å¯¹è±¡åç§°ï¼‰ï¼Œç„¶åæ·»åŠ  <code>make_qobject</code> å®ã€‚</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹æ˜¯å°†æ¨¡å—çš„å†…å®¹å¯¼å‡º <code>DataStructProperties</code> ç»™ Qt/QMLã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå¯¹è±¡åç§°éœ€è¦æ˜¯å”¯ä¸€çš„ï¼Œä»¥é¿å…å†²çªï¼Œå°†æ¥å¯èƒ½ä¼šä½¿ç”¨å®Œæ•´çš„æ¨¡å—è·¯å¾„æ¥å¸®åŠ©é¿å…å†²çª<a href="https://github.com/KDAB/cxx-qt/issues/19">https://github.com/KDAB/cxx-qt/issues/19</a> - ä½†è¿™å¹¶ä¸èƒ½é˜»æ­¢è¯•å›¾æ³¨å†Œä¸¤ä¸ªå…·æœ‰ç›¸åŒåç§°çš„ QML ç±»å‹ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod data_struct_properties {
    #[derive(Default)]
    pub struct Data {
        number: i32,
    }

    #[derive(Default)]
    struct RustObj;
}
</code></pre>
<p>æ³¨æ„ï¼šè¿™å¯èƒ½ä¼šåœ¨æœªæ¥å‘ç”Ÿå˜åŒ–ï¼Œä»¥å…è®¸åœ¨å¯¼å‡ºåˆ° QML æ—¶å®šä¹‰åŸºç±»æˆ–é€‰é¡¹ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæˆä¸ºå‘½åç©ºé—´ <code>#[cxx_qt(QObject)]</code>( <a href="https://github.com/KDAB/cxx-qt/issues/22">https://github.com/KDAB/cxx-qt/issues/22</a> )ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="data-ç»“æ„ä¼‘"><a class="header" href="#data-ç»“æ„ä¼‘">Data ç»“æ„ä¼‘</a></h1>
<p>Data ç»“æ„ä½“å®šä¹‰äº† QObject ä¸Šåº”è¯¥å­˜åœ¨å“ªäº›å±æ€§ã€‚å®ƒè¿˜å…è®¸æ‚¨é€šè¿‡å®ç° <code>Default</code> trait æ¥ä¸ºå±æ€§æä¾›åˆå§‹å€¼ã€‚</p>
<p>æ³¨æ„ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨ Data ç»“æ„ä½“ä¸Šä½¿ç”¨ serde å¹¶æ´¾ç”Ÿ <code>Deserialize</code> å’Œ <code>Serialize</code>ï¼Œè¿™å…è®¸æ‚¨ååºåˆ—åŒ–å’Œåºåˆ—åŒ– QObject ä¸­çš„å±æ€§ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod data_struct_properties {
    #[derive(Default)]
    pub struct Data {
        number: i32,
    }

    #[derive(Default)]
    struct RustObj;
}
</code></pre>
<h2 id="default"><a class="header" href="#default">Default</a></h2>
<p>å¦‚æœä½ æƒ³ä¸º QObject æä¾›é»˜è®¤å€¼ï¼Œé‚£ä¹ˆä¸è¦ç»™ <code>Data</code> ç»“æ„ä½“æ´¾ç”Ÿå®ç° <code>Default</code> traitã€‚</p>
<h2 id="å±æ€§æšä¸¾"><a class="header" href="#å±æ€§æšä¸¾">å±æ€§æšä¸¾</a></h2>
<p>è°ƒç”¨ <code>Property</code> çš„æšä¸¾æ˜¯ä» <code>Data</code> ç»“æ„ä¸­çš„å­—æ®µåç§°è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œç„¶åå¯ä»¥åœ¨ <a href="qobject/./handlers.html"><code>PropertyChangeHandler</code></a>ä½¿ç”¨ã€‚</p>
<h2 id="åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a class="header" href="#åºåˆ—åŒ–å’Œååºåˆ—åŒ–">åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></h2>
<p>ä½¿ç”¨ <a href="https://serde.rs/">Serde</a> å¯ä»¥ï¼ˆåï¼‰åºåˆ—åŒ– Data ç»“æ„ä½“ï¼Œæ–¹æ³•æ˜¯åƒå¾€å¸¸ä¸€æ ·æ·»åŠ æ´¾ç”Ÿå±æ€§ã€‚</p>
<p>è¦å°†å¯¹è±¡ä» <code>Data</code> ç»“æ„ä½“åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œè¯·åœ¨ <code>Data</code> ç»“æ„ä½“ä¸ŠæŒ‰ç…§å¾€å¸¸é‚£æ ·ä½¿ç”¨ serdeï¼Œæƒ³ä»å¯è°ƒç”¨å‡½æ•°ä¸­è·å– <code>Data</code> ç»“æ„ä½“å®ä¾‹ï¼Œè¯·ä½¿ç”¨ <code>CppObj</code>ï¼Œä¾‹å¦‚ <code>Data::from(cpp)</code>ï¼Œå¦‚ä¸‹é¢å¯è°ƒç”¨å‡½æ•° <code>as_json_str</code> ä¸­æ‰€ç¤º.</p>
<p>è¦å°†ä¸€ä¸ªå¯¹è±¡ä»å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸º <code>Data</code> ç»“æ„ä½“ï¼Œè¯·ç…§å¸¸ä½¿ç”¨ serdeã€‚è¿™æ ·åšçš„ä¸¤ä¸ªä¸»è¦ç›®çš„æ˜¯ä¸º <code>Data</code> å®ç° <code>Default</code> æˆ–ä½¿ç”¨ä½¿ç”¨ <code>CppObj</code> çš„ <code>grab_values_from_data</code> æ–¹æ³•ï¼Œå¦‚åœ¨ <code>grab_values</code> å‡½æ•°ä¸­æ‰€ç¤ºã€‚</p>
<p>æ³¨æ„ï¼ŒQt ç±»å‹è¿˜ä¸èƒ½ï¼ˆåï¼‰åºåˆ—åŒ–( <a href="https://github.com/KDAB/cxx-qt/issues/16">https://github.com/KDAB/cxx-qt/issues/16</a> )ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod serialisation {
    use serde::{Deserialize, Serialize};

    #[derive(Deserialize, Serialize)]
    pub struct Data {
        number: i32,
        string: String,
    }

    impl Default for Data {
        fn default() -&gt; Self {
            let string = r#&quot;{&quot;number&quot;: 4, &quot;string&quot;: &quot;Hello World!&quot;}&quot;#;
            serde_json::from_str(string).unwrap()
        }
    }

    #[derive(Default)]
    struct RustObj;

    impl RustObj {
        #[invokable]
        fn as_json_str(&amp;self, cpp: &amp;mut CppObj) -&gt; String {
            let data = Data::from(cpp);
            serde_json::to_string(&amp;data).unwrap()
        }

        #[invokable]
        fn grab_values(&amp;self, cpp: &amp;mut CppObj) {
            let string = r#&quot;{&quot;number&quot;: 2, &quot;string&quot;: &quot;Goodbye!&quot;}&quot;#;
            let data: Data = serde_json::from_str(string).unwrap();
            cpp.grab_values_from_data(data);
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="rustobj-ç»“æ„ä½“"><a class="header" href="#rustobj-ç»“æ„ä½“">RustObj ç»“æ„ä½“</a></h1>
<p>RustObj ç»“æ„å…è®¸æ‚¨å®šä¹‰ä»¥ä¸‹éƒ¨ä»¶</p>
<ul>
<li>æš´éœ²ç»™ Qt çš„å¯è°ƒç”¨å‡½æ•°</li>
<li>åœ¨ RustObj ä¸­ä½¿ç”¨çš„ç§æœ‰æ–¹æ³•å’Œå­—æ®µï¼ˆä¾‹å¦‚ï¼Œè¿™å¯¹äºå­˜å‚¨<a href="qobject/../concepts/threading.html">çº¿ç¨‹</a>çš„é€šé“å¾ˆæœ‰ç”¨ï¼‰</li>
<li>ä½¿ç”¨ <a href="qobject/./cpp_object.html"><code>CppObj</code></a> æ”¹å˜ C++ çš„çŠ¶æ€</li>
<li>ä¸ºå±æ€§æˆ–æ›´æ–°è¯·æ±‚å®ç° <a href="qobject/./handlers.html">handlers</a></li>
</ul>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
pub mod rust_obj_invokables {
    #[derive(Default)]
    pub struct Data {
        number: i32,
    }

    struct RustObj {
        rust_only_field: i32,
    }

    impl Default for RustObj {
        fn default() -&gt; Self {
            Self { rust_only_field: 1 }
        }
    }

    impl RustObj {
        #[invokable]
        fn invokable_mutate_cpp(&amp;self, cpp: &amp;mut CppObj) {
            cpp.set_number(cpp.number() * 2);
        }

        #[invokable]
        fn invokable_return(&amp;self) -&gt; i32 {
            self.rust_only_field
        }

        #[invokable]
        fn invokable_multiply(&amp;mut self, factor: i32) -&gt; i32 {
            self.rust_only_method(factor);
            self.rust_only_field
        }

        fn rust_only_method(&amp;mut self, factor: i32) {
            self.rust_only_field *= factor;
        }
    }
}
</code></pre>
<h2 id="å¯è°ƒç”¨å‡½æ•°"><a class="header" href="#å¯è°ƒç”¨å‡½æ•°">å¯è°ƒç”¨å‡½æ•°</a></h2>
<p>è¦å®šä¹‰æš´éœ²ç»™ QML å’Œ C++ çš„æ–¹æ³•ï¼Œè¯·åœ¨ <code>RustObj</code> ç»“æ„ä¸Šæ·»åŠ å‡½æ•°å¹¶åœ¨å‡½æ•°æ·»åŠ å±æ€§ <code>#[invokable]</code>ã€‚ç„¶åå°†å‚æ•°å’Œè¿”å›ç±»å‹åŒ¹é…åˆ° Qt ç«¯ã€‚æ­¤å¤–ï¼ŒCXX-Qt ä¼šè‡ªåŠ¨åœ¨æ‚¨çš„å¯è°ƒç”¨å‡½æ•°è¿›è¡Œå°è£…ï¼Œä»¥è‡ªåŠ¨æ‰§è¡Œ <a href="qobject/../concepts/types.html">C++ å’Œ Rust ç±»å‹</a>ä¹‹é—´çš„ä»»ä½•è½¬æ¢ã€‚</p>
<p>æ³¨æ„ï¼Œè¦è®¿é—® C++ å¯¹è±¡çš„å±æ€§ï¼Œè¯·ä½¿ç”¨ <a href="qobject/./cpp_object.html">Cpp Object</a>ã€‚</p>
<h2 id="ç§æœ‰æ–¹æ³•å’Œå­—æ®µ"><a class="header" href="#ç§æœ‰æ–¹æ³•å’Œå­—æ®µ">ç§æœ‰æ–¹æ³•å’Œå­—æ®µ</a></h2>
<p>ä¸åŒäºåœ¨ <a href="qobject/./data_struct.html">Data ç»“æ„ä½“</a>ä¸Šå®šä¹‰çš„å­—æ®µï¼Œ<code>RustObj</code> å®šä¹‰çš„å­—æ®µä¸ä¼šä½œä¸ºå±æ€§å…¬å¼€ç»™ Qtã€‚è¿™å¯ä»¥è¢«è®¤ä¸ºæ˜¯â€œç§æœ‰çš„ Rustâ€å­—æ®µï¼Œå¹¶ä¸”å¯¹äºå­˜å‚¨çº¿ç¨‹çš„é€šé“æˆ– QObject çš„å†…éƒ¨ä¿¡æ¯å¾ˆæœ‰ç”¨ã€‚</p>
<p><code>RustObj</code> åœ¨æ²¡æœ‰ <code>#[invokable]</code> å±æ€§çš„æ–¹æ³•ä¸ä¼šæš´éœ²ç»™ C++ï¼Œå¹¶ä¸”è¢«è®¤ä¸ºæ˜¯â€œç§æœ‰çš„ Rustâ€æ–¹æ³•ã€‚ä¸å­—æ®µç±»ä¼¼ï¼Œè¿™äº›å¯¹äºçº¿ç¨‹å’Œå†…éƒ¨ä¿¡æ¯å¾ˆæœ‰ç”¨ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="cpp-å¯¹è±¡"><a class="header" href="#cpp-å¯¹è±¡">Cpp å¯¹è±¡</a></h1>
<p>è¦è®¿é—®å’Œæ”¹å˜ C++ ç«¯ï¼Œä¾‹å¦‚å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¥æŸ„æ¥è®¿é—® C++ å¯¹è±¡ã€‚ä¸ºäº†å®‰å…¨åœ°åšåˆ°è¿™ä¸€ç‚¹ï¼ŒCXX-Qt æä¾›äº†ä¸€ç§ <code>CppObj</code> ç±»å‹ï¼Œå®ƒæ˜¯ç”Ÿæˆçš„ C++ å¯¹è±¡çš„å®‰å…¨å°è£…ã€‚
To access and mutate the C++ side, eg properties, we need a handle to access the C++ object. To do this safely CXX-Qt provides a <code>CppObj</code> type which is a safe wrapper around the generated C++ object.</p>
<h2 id="å¯è°ƒç”¨å‡½æ•°-1"><a class="header" href="#å¯è°ƒç”¨å‡½æ•°-1">å¯è°ƒç”¨å‡½æ•°</a></h2>
<p>è¦ä½¿ç”¨ <code>CppObj</code>ï¼Œè¯·åœ¨å¯è°ƒç”¨çš„å‚æ•°ä¸­æ·»åŠ  <code>cpp: &amp;mut CppObj</code>ã€‚</p>
<p>å¦‚æœ <a href="qobject/./data_struct.html"><code>Data</code> ç»“æ„ä½“</a>æœ‰ä¸€ä¸ªåä¸º <code>number: i32</code> çš„å­—æ®µï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨ <code>CppObj</code> çš„ <code>number(&amp;self) -&gt; i32</code> å’Œ <code>set_number(&amp;mut self, number: i32)</code> æ¥è®¿é—®å±æ€§ã€‚</p>
<pre><code class="language-rust ignore noplayground">        #[invokable]
        fn invokable_mutate_cpp(&amp;self, cpp: &amp;mut CppObj) {
            cpp.set_number(cpp.number() * 2);
        }
</code></pre>
<p>å¦‚æœæœ‰ä¸€ä¸ª <a href="qobject/./signals_enum.html"><code>Signals</code> æšä¸¾</a>ï¼Œé‚£ä¹ˆä½ å¯ä»¥è°ƒç”¨ <code>CppObj</code> çš„ <code>emit_queued(&amp;mut self, Signals)</code> æˆ– <code>unsafe emit_immediate(&amp;mut self, Signals)</code> å‘å‡ºä¸€ä¸ªä¿¡å·ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>emit_immediate</code> æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¦‚æœ <code>Q_EMIT</code> ç”¨ <code>Qt::DirectConnection</code> æ–¹å¼è¿æ¥åˆ°åŒä¸€ä¸ªå·²ç»è¢« <code>Q_EMIT</code> çš„ QObject ä¸Šçš„ Rust å¯è°ƒç”¨å‡½æ•°ï¼Œåˆ™å¯èƒ½å¯¼è‡´æ­»é”ï¼Œå› ä¸ºè¿™å°è¯•é”å®šå·²é”å®šçš„ <code>RustObj</code>ã€‚</p>
<pre><code class="language-rust ignore noplayground">impl RustObj {
    #[invokable]
    fn invokable(&amp;self, cpp: &amp;mut CppObj) {
        unsafe { cpp.emit_immediate(Signal::Ready); }

        cpp.emit_queued(Signal::DataChanged { data: 1 });
    }
}
</code></pre>
<h2 id="çº¿ç¨‹"><a class="header" href="#çº¿ç¨‹">çº¿ç¨‹</a></h2>
<p><code>CppObj</code> å¯ä»¥é€šè¿‡ <code>update_requester(&amp;self) -&gt; cxx_qt_lib::update_requester::UpdateRequester</code> æ–¹æ³•æ¥ç”¨äºçº¿ç¨‹ä¸Šè®¿é—® <code>UpdateRequester</code>ã€‚</p>
<pre><code class="language-rust ignore noplayground">            // Retrieve the update requester from the CppObj
            let update_requester = cpp.update_requester();
</code></pre>
<p><code>UpdateRequester</code> è¢«ç§»åŠ¨åˆ° Rust çº¿â€‹â€‹ç¨‹ä¸­ï¼Œç„¶ååœ¨ <code>request_update(&amp;self) -&gt; bool</code> è¢«è°ƒç”¨æ—¶è§¦å‘Qt çº¿ç¨‹ä¸Šçš„ <a href="qobject/./handlers.html"><code>UpdateRequestHandler</code></a> ã€‚</p>
<pre><code class="language-rust ignore noplayground">                // Request an update from the background thread
                update_requester.request_update();
</code></pre>
<h2 id="åºåˆ—åŒ–å’Œååºåˆ—åŒ–-1"><a class="header" href="#åºåˆ—åŒ–å’Œååºåˆ—åŒ–-1">åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></h2>
<p>å¦‚ <a href="qobject/./data_struct.html">Data struct</a> çš„ï¼ˆåï¼‰åºåˆ—åŒ–éƒ¨åˆ†æ‰€è¿°ï¼Œ<code>CppObj</code> æœ‰ä¸€ä¸ªæ–¹æ³• <code>grab_values_from_data</code>ï¼Œå®ƒå¯ä»¥ä» <code>Data</code> åŠ è½½å€¼åˆ° C++ å®ä¾‹ä¸­ã€‚</p>
<pre><code class="language-rust ignore noplayground">        #[invokable]
        fn grab_values(&amp;self, cpp: &amp;mut CppObj) {
            let string = r#&quot;{&quot;number&quot;: 2, &quot;string&quot;: &quot;Goodbye!&quot;}&quot;#;
            let data: Data = serde_json::from_str(string).unwrap();
            cpp.grab_values_from_data(data);
        }
</code></pre>
<h2 id="ç±»å‹å°è£…"><a class="header" href="#ç±»å‹å°è£…">ç±»å‹å°è£…</a></h2>
<p>å½“ä½¿ç”¨ getter æˆ– setter è®¿é—® C++ å±æ€§å€¼æ—¶ï¼ŒRust getter å’Œ setter ä¼šè‡ªåŠ¨æ‰§è¡Œ <a href="qobject/../concepts/types.html">C++ å’Œ Rust ç±»å‹</a> ä¹‹é—´çš„ä»»ä½•è½¬æ¢ã€‚è¿™å…è®¸ Rust ä»£ç ä½¿ç”¨ Rust ç±»å‹è¡¨ç¤ºï¼Œè€Œæ— éœ€è½¬æ¢ä¸º C++ ç±»å‹æˆ–ä» C++ ç±»å‹è½¬æ¢ã€‚</p>
<p>TODOï¼šè§£é‡Šæˆ‘ä»¬åœ¨ä¹‹åå¦‚ä½•ä»å­å¯¹è±¡ç­‰ä¸­å°†å…¶ç”¨äº borrowRustObjï¼ˆå¹¶æ³¨æ„æ­¤å¤„çš„çº¿ç¨‹ï¼‰ï¼Œä¾‹å¦‚ nested_object() å¯ä»¥è¿”å› <code>Borrow&lt;T&gt;</code>ã€‚</p>
<p>TODOï¼šä¸€æ—¦æˆ‘ä»¬æœ‰äº† borrow_rust_obj()ï¼Œè¯·è§£é‡Šå¦‚ä½•ä½¿ç”¨å®ƒæ¥è®¿é—®å¦ä¸€ä¸ªå¯¹è±¡ RustObj ( <a href="https://github.com/KDAB/cxx-qt/issues/30">https://github.com/KDAB/cxx-qt/issues/30</a> )ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="signals-æšä¸¾"><a class="header" href="#signals-æšä¸¾">Signals æšä¸¾</a></h1>
<p>ä¿¡å·æšä¸¾å®šä¹‰äº† QObject ä¸Šåº”è¯¥å­˜åœ¨å“ªäº›ä¿¡å·ã€‚å®ƒå…è®¸æ‚¨å®šä¹‰ä¿¡å·åç§°å’Œä¿¡å·çš„å‚æ•°ã€‚</p>
<pre><code class="language-rust ignore noplayground">    pub enum Signal {
        Ready,
        RustDataChanged { data: i32 },
        TrivialDataChanged { trivial: QPoint },
        OpaqueDataChanged { opaque: QVariant },
    }
</code></pre>
<h2 id="å‘å‡ºä¿¡å·"><a class="header" href="#å‘å‡ºä¿¡å·">å‘å‡ºä¿¡å·</a></h2>
<p>è¦ä» Rust å‘å‡ºä¿¡å·ï¼Œè¯·ä½¿ç”¨ <a href="qobject/./cpp_object.html"><code>CppObj</code></a> å¹¶è°ƒç”¨ <code>emit_queued(Signal)</code> æˆ–è€… <code>unsafe emit_immediate(Signal)</code> æ–¹æ³•ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>emit_immediate</code> æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¦‚æœ <code>Q_EMIT</code> ç”¨ <code>Qt::DirectConnection</code>çš„æ–¹å¼è¿æ¥åˆ°çš„åŒä¸€ä¸ªå·²ç»è¢« Q_EMIT çš„ QObject ä¸Šçš„ Rust å¯è°ƒç”¨å‡½æ•°ï¼Œåˆ™å¯èƒ½å¯¼è‡´æ­»é”ï¼Œå› ä¸ºè¿™ä¼šå°è¯•é”å®šå·²é”å®šçš„ <code>RustObj</code>ã€‚</p>
<pre><code class="language-rust ignore noplayground">    impl RustObj {
        #[invokable]
        fn invokable(&amp;self, cpp: &amp;mut CppObj) {
            unsafe {
                cpp.emit_immediate(Signal::Ready);
            }

            cpp.emit_queued(Signal::RustDataChanged { data: cpp.data() });
            cpp.emit_queued(Signal::TrivialDataChanged {
                trivial: *cpp.trivial(),
            });
            cpp.emit_queued(Signal::OpaqueDataChanged {
                opaque: cpp.opaque(),
            });
        }
    }
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="handlers"><a class="header" href="#handlers">Handlers</a></h1>
<p>Handler ç”¨äºå¯¹ Qt äº‹ä»¶å¾ªç¯çº¿ç¨‹ä¸Šçš„äº‹ä»¶ä½œå‡ºååº”ã€‚è¿™å…è®¸ Rust å¯¹æ¥è‡ª C++ çš„äº‹ä»¶åšå‡ºååº”ï¼Œåœ¨ Qt å‰ç«¯çº¿ç¨‹ä¸Šå¤„ç†æ¥è‡ªåç«¯ Rust çº¿â€‹â€‹ç¨‹çš„è§¦å‘ï¼Œå¹¶é¿å…æ­»é”ã€‚</p>
<p>ä¸‹é¢åˆ—å‡ºäº†ä¸€äº›å¯ç”¨çš„ handler</p>
<ul>
<li>PropertyChangeHandler åœ¨å±æ€§å€¼å‘ç”Ÿæ›´æ”¹æ—¶è¿›è¡Œå¤„ç†</li>
<li>UpdateRequestHandler ç”¨äºå¤„ç† Qt äº‹ä»¶å¾ªç¯çº¿ç¨‹ä¸Šçš„æ›´æ–°è¯·æ±‚ï¼Œæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="qobject/../concepts/threading.html">çº¿ç¨‹</a>ç« èŠ‚ã€‚</li>
</ul>
<h2 id="propertychangehandler"><a class="header" href="#propertychangehandler">PropertyChangeHandler</a></h2>
<p>å½“ <a href="qobject/./data_struct.html">Data ç»“æ„ä½“</a> ä¸­å®šä¹‰çš„å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ— è®ºæ˜¯é€šè¿‡ Rust è°ƒç”¨ setter è¿˜æ˜¯é€šè¿‡ QML/C++ è°ƒç”¨ setterï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ <code>PropertyChangeHandler</code>.</p>
<p>ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œç›‘å¬äº† number å±æ€§ï¼Œå¹¶åœ¨ <code>number</code> å±æ€§å˜åŒ–æ—¶è§¦å‘ <code>handle_property_change</code>ã€‚å®ƒä½¿ç”¨ä¸€ä¸ªåœ¨ <a href="qobject/./data_struct.html">data ç»“æ„ä½“</a>ä¸­å®šä¹‰çš„å±æ€§åç§°è‡ªåŠ¨ç”Ÿæˆçš„ <code>Property</code> æšä¸¾ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä» Qt äº‹ä»¶å¾ªç¯çº¿ç¨‹è°ƒç”¨çš„ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod handler_property_change {
    #[derive(Default)]
    pub struct Data {
        number: i32,
    }

    #[derive(Default)]
    struct RustObj {
        count: u32,
    }

    impl RustObj {
        #[invokable]
        fn get_count(&amp;self) -&gt; u32 {
            self.count
        }
    }

    impl PropertyChangeHandler&lt;CppObj&lt;'_&gt;, Property&gt; for RustObj {
        fn handle_property_change(&amp;mut self, cpp: &amp;mut CppObj, property: Property) {
            match property {
                Property::Number =&gt; {
                    println!(&quot;New Number: {}&quot;, cpp.number());
                    self.count += 1;
                }
                _others =&gt; {}
            }
        }
    }
}
</code></pre>
<h2 id="updaterequesthandler"><a class="header" href="#updaterequesthandler">UpdateRequestHandler</a></h2>
<p>å½“åç«¯ Rust çº¿â€‹â€‹ç¨‹ä½¿ç”¨ <code>UpdateRequester</code> è¯·æ±‚ Qt çº¿ç¨‹é€šè¿‡ <code>request_update</code> æ¥è¿›è¡ŒåŒæ­¥æ—¶ï¼Œ è¿™ä¼šè§¦å‘ <code>UpdateRequestHandler</code> çš„ <code>handle_update_request</code> æ–¹æ³•ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å¯è°ƒç”¨å‡½æ•°ä¸­ï¼Œ<a href="qobject/./cpp_object.html"><code>CppObj</code></a> ç”¨äºæ£€ç´¢ <code>UpdateRequester</code>.</p>
<pre><code class="language-rust ignore noplayground">            // Retrieve the update requester from the CppObj
            let update_requester = cpp.update_requester();
</code></pre>
<p><code>UpdateRequester</code> è¢«ç§»åŠ¨åˆ°çº¿ç¨‹ä¸­ï¼Œç„¶ååœ¨éœ€è¦æ—¶è¯·æ±‚æ›´æ–°ã€‚</p>
<pre><code class="language-rust ignore noplayground">                // Request an update from the background thread
                update_requester.request_update();
</code></pre>
<p>ç„¶ååœ¨ä¹‹åçš„é˜¶æ®µä¸­ä» Qt äº‹ä»¶å¾ªç¯çº¿ç¨‹è§¦å‘ <code>handle_update_request</code>ã€‚å®ƒå¯ä»¥éå† event_queueï¼ˆä¾‹å¦‚æ¥è‡ªåç«¯çº¿ç¨‹çš„é€šé“ï¼‰ï¼Œä»¥å°†å€¼æ›´æ–°åˆ° Qt å¯¹è±¡ä¸­ï¼ˆé€šè¿‡å¸¦æœ‰ CppObj çš„ process_eventï¼‰ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™æ˜¯ä» Qt äº‹ä»¶å¾ªç¯çº¿ç¨‹è°ƒç”¨çš„ã€‚</p>
<pre><code class="language-rust ignore noplayground">    impl UpdateRequestHandler&lt;CppObj&lt;'_&gt;&gt; for RustObj {
        fn handle_update_request(&amp;mut self, cpp: &amp;mut CppObj) {
            while let Some(event) = self.event_queue.next().now_or_never() {
                if let Some(event) = event {
                    self.process_event(&amp;event, cpp);
                }
            }
        }
    }
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="æ¦‚å¿µ"><a class="header" href="#æ¦‚å¿µ">æ¦‚å¿µ</a></h1>
<h2 id="åŸºæœ¬æ¦‚å¿µ"><a class="header" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></h2>
<ul>
<li><a href="concepts/./bridge.html">Bridge</a></li>
<li><a href="concepts/./qt.html">æ”¯æŒçš„ Qt ç‰¹æ€§</a></li>
<li><a href="concepts/./types.html">Rust and C++ ä¹‹é—´æ”¯æŒçš„ç±»å‹</a></li>
</ul>
<h2 id="æ„å»ºå·¥å…·"><a class="header" href="#æ„å»ºå·¥å…·">æ„å»ºå·¥å…·</a></h2>
<ul>
<li><a href="concepts/./build_rs_and_cargo.html">Build.rs å’Œ Cargo.toml æ–‡ä»¶</a></li>
<li><a href="concepts/./cmake.html">CMake é›†æˆ</a></li>
<li><a href="concepts/./register_types.html">æ³¨å†Œç±»å‹</a></li>
<li><a href="concepts/./qqmlextensionplugin.html">å¯¼å‡º Rust objects ä¸º QQmlExtensionPlugin</a></li>
</ul>
<h2 id="è¿›é˜¶æ¦‚å¿µ"><a class="header" href="#è¿›é˜¶æ¦‚å¿µ">è¿›é˜¶æ¦‚å¿µ</a></h2>
<ul>
<li><a href="concepts/./threading.html">çº¿ç¨‹ä¸å®‰å…¨</a></li>
<li><a href="concepts/./nested_objects.html">åµŒå¥—çš„ Rust å¯¹è±¡</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="bridge"><a class="header" href="#bridge">Bridge</a></h1>
<p>CXX-Qt ä½¿ç”¨ <a href="https://cxx.rs/">CXX</a> ä»¥ä¸€ç§å®‰å…¨çš„æ–¹å¼åœ¨ C++ å’Œ Rust ä¹‹é—´æ¶èµ·æ¡¥æ¢ã€‚</p>
<p>CXX-Qt æä¾›äº†ç”¨äºå£°æ˜ Qt å¯¹è±¡ï¼ˆä¾‹å¦‚ <a href="concepts/../qobject/index.html">QObject</a>ï¼‰çš„å®ï¼Œè€Œä¸”ä»ç„¶ä¿æŒç€ Rust ä»£ç é£æ ¼ã€‚</p>
<p>æˆ‘ä»¬æä¾›ä¸€äº› <a href="concepts/./types.html">Qt ç±»å‹</a>æ¥è¾…åŠ©åœ¨ Rust å’Œ Qt ä¹‹é—´ä¼ é€’é€šç”¨æ•°æ®ç±»å‹ã€‚</p>
<p>å½“ Rust å‡½æ•°æš´éœ²ç»™ C++ æ—¶ï¼Œæˆ‘ä»¬ä¼šè‡ªåŠ¨æ‰§è¡Œ snake_case å’Œ camelCase ä¹‹é—´çš„è½¬æ¢ã€‚å› æ­¤é¡¹ç›®ï¼ˆä¾‹å¦‚å±æ€§å’Œå¯è°ƒç”¨å‡½æ•°ï¼‰åœ¨ C++ ä¸­æ˜¾ç¤ºä¸º  camelCase é£æ ¼ï¼Œè€Œåœ¨ Rust ä¸­æ˜¾ç¤ºä¸º  snake_case é£æ ¼ã€‚</p>
<p>æ³¨æ„ï¼ŒRust <a href="concepts/../qobject/rustobj_struct.html"><code>RustObj</code></a>æ„é€ çš„ Qt å¯¹è±¡ç”± C++ ç«¯æŒæœ‰ã€‚å› æ­¤ï¼Œå½“ C++ å¯¹è±¡é”€æ¯æ—¶ï¼ŒRust å¯¹è±¡ä¹Ÿä¼šé”€æ¯ã€‚åœ¨å°†æ¥ï¼Œä¼šæœ‰ç”¨äºä» C++ å¯¹è±¡çš„æ„é€ å‡½æ•°æˆ–è€…ææ„å‡½æ•°ä¸­æ‰§è¡Œ Rust ä»£ç çš„ <a href="concepts/../qobject/handlers.html">handlers</a> <a href="https://github.com/KDAB/cxx-qt/issues/13">https://github.com/KDAB/cxx-qt/issues/13</a>ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="qt"><a class="header" href="#qt">Qt</a></h1>
<h2 id="å¯è°ƒç”¨å‡½æ•°-2"><a class="header" href="#å¯è°ƒç”¨å‡½æ•°-2">å¯è°ƒç”¨å‡½æ•°</a></h2>
<p>å¯ä»¥ä½¿ç”¨ <a href="concepts/../qobject/rustobj_struct.html">RustObj ç»“æ„ä½“</a>å®šä¹‰å¯è°ƒç”¨å‡½æ•°ï¼Œè¿™äº›å¯¼å‡ºä¸ºå¸¦æœ‰ <code>Q_INVOKABLE</code> çš„ C++ ç±»ä¸Šçš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨ QML è®¿é—®ã€‚
Invokables can be defined using the <a href="concepts/../qobject/rustobj_struct.html">RustObj Struct</a>, these will be exposed as methods on the C++ class with <code>Q_INVOKABLE</code> so that they are accessible for QML too.</p>
<h2 id="å±æ€§"><a class="header" href="#å±æ€§">å±æ€§</a></h2>
<p>å¯ä»¥ä½¿ç”¨ <a href="concepts/../qobject/data_struct.html">Data ç»“æ„ä½“</a>å®šä¹‰å±æ€§ï¼Œè¿™ä¼šç”Ÿæˆ getter å’Œ setter æ–¹æ³•ã€å˜åŒ–ä¿¡å·å’Œ C++ ç±»ä¸Šçš„ <code>Q_PROPERTY</code>ï¼Œå› æ­¤ä¹Ÿä½œä¸º QML å±æ€§ã€‚</p>
<h2 id="ä¿¡å·"><a class="header" href="#ä¿¡å·">ä¿¡å·</a></h2>
<p>å¯ä»¥ä½¿ç”¨ <a href="concepts/../qobject/signals_enum.html">Signals æšä¸¾</a>æ¥å®šä¹‰ä¿¡å·ï¼Œè¿™äº›å°†å¯¼å‡ºä¸º C++ ç±»ä¸­çš„ <code>Q_SIGNALS</code>ï¼Œå› æ­¤ä¹Ÿä¼šå¯¼å‡ºç»™ QMLã€‚</p>
<h2 id="å˜åŒ–äº‹ä»¶"><a class="header" href="#å˜åŒ–äº‹ä»¶">å˜åŒ–äº‹ä»¶</a></h2>
<p>æ‚¨å¯ä»¥é€šè¿‡ RustObj Struct ä¸­å¯ç”¨çš„ <a href="concepts/../qobject/handlers.html">handlers</a> æ¥ç›‘å¬å±æ€§çš„å˜åŒ–ã€‚è¿™äº› handlers ä» Qt äº‹ä»¶å¾ªç¯çº¿ç¨‹è°ƒç”¨ä»¥ä¿æŒ<a href="concepts/./threading.html">çº¿ç¨‹å®‰å…¨</a>ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="ç±»å‹"><a class="header" href="#ç±»å‹">ç±»å‹</a></h1>
<h2 id="åŸºç¡€ç±»å‹"><a class="header" href="#åŸºç¡€ç±»å‹">åŸºç¡€ç±»å‹</a></h2>
<p>è¿™äº›ç±»å‹å¯ç”¨äºå¯è°ƒç”¨å‡½æ•°çš„å±æ€§ã€å‚æ•°æˆ–è¿”å›ç±»å‹ï¼Œä»¥åŠä¿¡å·ä¸­çš„å‚æ•°ï¼Œæ— éœ€ä»»ä½•è½¬æ¢ã€‚</p>
<p>å®ƒä»¬åœ¨æ¡¥çš„ C++ å’Œ Rust ç«¯éƒ½æ˜¾ç¤ºä¸ºå®ƒä»¬çš„å¸¸è§„ç±»å‹ã€‚</p>
<table><thead><tr><th>Rust ç±»å‹</th><th>C++ ç±»å‹</th></tr></thead><tbody>
<tr><td>bool</td><td>bool</td></tr>
<tr><td>f32</td><td>float</td></tr>
<tr><td>f64</td><td>double</td></tr>
<tr><td>i8</td><td>qint8</td></tr>
<tr><td>i16</td><td>qint16</td></tr>
<tr><td>i32</td><td>qint32</td></tr>
<tr><td>u8</td><td>quint8</td></tr>
<tr><td>u16</td><td>quint16</td></tr>
<tr><td>u32</td><td>quint32</td></tr>
</tbody></table>
<p>TODOï¼šè¯·æ³¨æ„ï¼Œç›®å‰æš‚ä¸æ”¯æŒ u64/quint64 ( <a href="https://github.com/KDAB/cxx-qt/issues/36">https://github.com/KDAB/cxx-qt/issues/36</a> )ã€‚</p>
<h2 id="è‡ªå®šä¹‰ç±»å‹"><a class="header" href="#è‡ªå®šä¹‰ç±»å‹">è‡ªå®šä¹‰ç±»å‹</a></h2>
<p>è¿™äº›ç±»å‹æ˜¯è‡ªå®šä¹‰çš„ï¼Œåœ¨ Rust å’Œ C++ ä¹‹é—´ä¼ é€’å‰éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨ cxx_qt_lib crate ä¸­æä¾›äº†ä¸€äº›è¾…åŠ©ç±»å‹ã€‚</p>
<p>åœ¨è¿™äº›è‡ªå®šä¹‰ç±»å‹ä¸­ï¼Œæœ‰ä¸¤ç§éœ€è¦è€ƒè™‘</p>
<ul>
<li>ç®€å•çš„</li>
<li>å¤æ‚çš„</li>
</ul>
<h3 id="è‡ªå®šä¹‰ç®€å•ç±»å‹"><a class="header" href="#è‡ªå®šä¹‰ç®€å•ç±»å‹">è‡ªå®šä¹‰ç®€å•ç±»å‹</a></h3>
<p>è‡ªå®šä¹‰ç®€å•ç±»å‹ï¼Œå’ŒåŸºç¡€ç±»å‹ä¸€æ ·ï¼Œå¯ç”¨äºå¯è°ƒç”¨å‡½æ•°ä¸­çš„å±æ€§ã€å‚æ•°æˆ–è¿”å›ç±»å‹ï¼Œä»¥åŠä¿¡å·ä¸­çš„å‚æ•°ï¼Œæ— éœ€ä»»ä½•è½¬æ¢ã€‚</p>
<p>åœ¨ Rust ç«¯ï¼Œè‡ªå®šä¹‰ç®€å•ç±»å‹ä»¥ cxx_qt_lib è¾…åŠ©ç±»å‹çš„å½¢å¼å‡ºç°ã€‚</p>
<p>æ³¨æ„ï¼Œå½“å®ƒä»¬åœ¨å¯è°ƒç”¨å‡½æ•°ä¸­ç”¨ä½œå‚æ•°ç±»å‹æ—¶ï¼Œåº”è¯¥ä»¥å¼•ç”¨çš„æ–¹å¼ä¼ é€’ï¼Œå¦‚ <code>pointf: &amp;QPointF</code>ï¼Œå½“æ˜¯å±æ€§æˆ–è¿”å›ç±»å‹æ—¶ï¼Œåº”è¯¥ä»¥å€¼ä¼ é€’ï¼Œå¦‚ <code>QPointF</code>ã€‚</p>
<table><thead><tr><th>Rust ç±»å‹</th><th>C++ ç±»å‹</th></tr></thead><tbody>
<tr><td>cxx_qt_lib::QDate</td><td>QDate</td></tr>
<tr><td>cxx_qt_lib::QPoint</td><td>QPoint</td></tr>
<tr><td>cxx_qt_lib::QPointF</td><td>QPointF</td></tr>
<tr><td>cxx_qt_lib::QRect</td><td>QRect</td></tr>
<tr><td>cxx_qt_lib::QRectF</td><td>QRectF</td></tr>
<tr><td>cxx_qt_lib::QTime</td><td>QTime</td></tr>
</tbody></table>
<h3 id="è‡ªå®šä¹‰å¤æ‚ç±»å‹"><a class="header" href="#è‡ªå®šä¹‰å¤æ‚ç±»å‹">è‡ªå®šä¹‰å¤æ‚ç±»å‹</a></h3>
<p>è‡ªå®šä¹‰å¤æ‚ç±»å‹å°è£…äº†ä¸€ä¸ªæŒ‡å‘ C++ ç±»å‹çš„å”¯ä¸€æŒ‡é’ˆï¼Œå®ƒä»¬çš„ä½¿ç”¨æ–¹å¼ä¸è‡ªå®šä¹‰æ™®é€šç±»å‹ç›¸åŒï¼Œä½† CXX-Qt è‡ªåŠ¨ç¼–å†™å°è£…æ¥è½¬æ¢è¯¥ç±»å‹çš„ C++ å”¯ä¸€æŒ‡é’ˆå’Œè¯¥ç±»å‹çš„ Rust å°è£…ã€‚</p>
<p>åœ¨ Rust ç«¯ï¼Œè‡ªå®šä¹‰å¤æ‚ç±»å‹ä»¥ cxx_qt_lib è¾…åŠ©ç±»å‹çš„å½¢å¼å‡ºç°ã€‚</p>
<p>æ³¨æ„ï¼Œå½“å®ƒä»¬åœ¨å¯è°ƒç”¨å‡½æ•°ä¸­ç”¨ä½œå‚æ•°ç±»å‹æ—¶ï¼Œåº”è¯¥ä»¥å¼•ç”¨çš„æ–¹å¼ä¼ é€’ï¼Œä¾‹å¦‚ <code>color: &amp;QColor</code>ï¼Œå½“æ˜¯å±æ€§æˆ–è¿”å›ç±»å‹æ—¶ï¼Œåº”è¯¥å€¼ä»¥å€¼ä¼ é€’ï¼Œä¾‹å¦‚ <code>QColor</code>ã€‚åŒæ ·ï¼Œå­—ç¬¦ä¸²ç±»å‹ <code>&amp;str</code> ä»¥å¼•ç”¨çš„å½¢å¼ä¼ é€’ï¼Œ<code>String</code> ä»¥å€¼çš„å½¢å¼è¿›è¡Œä¼ é€’ã€‚</p>
<table><thead><tr><th>Rust ç±»å‹</th><th>C++ ç±»å‹</th></tr></thead><tbody>
<tr><td>cxx_qt_lib::QColor</td><td>QColor</td></tr>
<tr><td>cxx_qt_lib::QDateTime</td><td>QDateTime</td></tr>
<tr><td>String or &amp;str</td><td>QString</td></tr>
<tr><td>cxx_qt_lib::QUrl</td><td>QUrl</td></tr>
<tr><td>cxx_qt_lib::QVariant</td><td>QVariant</td></tr>
</tbody></table>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä»¥ QVariant ä½œä¸ºå‚æ•°ã€è¿”å›ç±»å‹å’Œå±æ€§çš„ä¾‹å­ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod types {
    use cxx_qt_lib::{QVariant, QVariantValue};

    pub struct Data {
        variant: QVariant,
    }

    impl Default for Data {
        fn default() -&gt; Self {
            Data {
                variant: QVariant::from(1_i32),
            }
        }
    }

    #[derive(Default)]
    struct RustObj;

    impl RustObj {
        #[invokable]
        fn test_variant_property(&amp;self, cpp: &amp;mut CppObj) {
            match cpp.variant().value() {
                QVariantValue::Bool(b) =&gt; {
                    cpp.set_variant(QVariant::from(!b));
                }
                QVariantValue::I32(i) =&gt; {
                    cpp.set_variant(QVariant::from(i * 2));
                }
                _ =&gt; panic!(&quot;Incorrect variant type!&quot;),
            }
        }

        #[invokable]
        fn test_variant_invokable(&amp;self, variant: &amp;QVariant) -&gt; QVariant {
            match variant.value() {
                QVariantValue::Bool(b) =&gt; QVariant::from(!b),
                QVariantValue::I32(i) =&gt; QVariant::from(i * 2),
                _ =&gt; panic!(&quot;Incorrect variant type!&quot;),
            }
        }
    }
}
</code></pre>
<h2 id="æœªæ¥å¯èƒ½æ”¯æŒçš„ç±»å‹"><a class="header" href="#æœªæ¥å¯èƒ½æ”¯æŒçš„ç±»å‹">æœªæ¥å¯èƒ½æ”¯æŒçš„ç±»å‹</a></h2>
<ul>
<li>Enums</li>
<li>Lists</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="buildrs"><a class="header" href="#buildrs">Build.rs</a></h1>
<p>æˆ‘ä»¬éœ€è¦æŒ‡å®šä¸€ä¸ª build.rs æ–‡ä»¶ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è§£æå®å¹¶ç”Ÿæˆç›¸å…³çš„ C++ ä»£ç ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹</p>
<ul>
<li>æŒ‡ç¤ºåº”è§£æå“ªäº›æ–‡ä»¶ä»¥æŸ¥æ‰¾å®</li>
<li>å¯ç”¨æ„å»ºä¸º <a href="concepts/./qqmlextensionplugin.html">QQmlExtensionPlugin</a></li>
<li>ç¡®å®šç”Ÿæˆçš„ C++ ä»£ç çš„ clang æ ¼å¼æ ·å¼</li>
<li>ä¸ºç”Ÿæˆçš„ Rust ç±»å‹æŒ‡å®šè‡ªå®šä¹‰ C++ å‘½åç©ºé—´</li>
</ul>
<p>build.rs è„šæœ¬å¦‚ä¸‹æ‰€ç¤º</p>
<pre><code class="language-rust ignore noplayground">use clang_format::ClangFormatStyle;
use cxx_qt_build::CxxQtBuilder;

fn main() {
    CxxQtBuilder::new()
        .cpp_format(ClangFormatStyle::Mozilla)
        .file(&quot;src/lib.rs&quot;)
        .build();
}
</code></pre>
<p>å¦‚æœæ‚¨è¦æ³¨å†Œä¸ºæ’ä»¶ï¼Œbuild.rs å¦‚ä¸‹æ‰€ç¤º</p>
<pre><code class="language-rust ignore noplayground">use clang_format::ClangFormatStyle;
use cxx_qt_build::CxxQtBuilder;

fn main() {
    CxxQtBuilder::new()
        .qqmlextensionplugin(
            &quot;com.kdab.cxx_qt.demo&quot;, // QML import name
            &quot;core_qmlplugin&quot;,       // C++ library target name
        )
        .cpp_format(ClangFormatStyle::Mozilla)
        .file(&quot;src/lib.rs&quot;)
        .build();
}
</code></pre>
<p>éé»˜è®¤ C++ å‘½åç©ºé—´å¯èƒ½å¦‚ä¸‹æ‰€ç¤º</p>
<p>è¯·æ³¨æ„ï¼Œå‘½åç©ºé—´æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥ <code>vec![&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</code> ä¼šå˜æˆ <code>a::b::c</code></p>
<pre><code class="language-rust ignore noplayground">use clang_format::ClangFormatStyle;
use cxx_qt_build::CxxQtBuilder;

fn main() {
    CxxQtBuilder::new()
        .cpp_format(ClangFormatStyle::Mozilla)
        .cpp_namespace_prefix(vec![&quot;custom_namespace&quot;])
        .file(&quot;src/data_struct_properties.rs&quot;)
        .file(&quot;src/empty.rs&quot;)
        .file(&quot;src/handler_property_change.rs&quot;)
        .file(&quot;src/lib.rs&quot;)
        .file(&quot;src/mock_qt_types.rs&quot;)
        .file(&quot;src/nested.rs&quot;)
        .file(&quot;src/rust_obj_invokables.rs&quot;)
        .file(&quot;src/serialisation.rs&quot;)
        .file(&quot;src/signals.rs&quot;)
        .file(&quot;src/sub.rs&quot;)
        .file(&quot;src/types.rs&quot;)
        .build();
}
</code></pre>
<h1 id="cargotoml"><a class="header" href="#cargotoml">Cargo.toml</a></h1>
<p><code>Cargo.toml</code> é¡¹ç›®æ–‡ä»¶åªéœ€å¾ˆå°‘çš„æ›´æ”¹å³å¯ä½¿ç”¨ CXX-Qtã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç›®å‰éœ€è¦æ„å»ºä¸ºé™æ€åº“ï¼ˆå› ä¸º Rust åº“é™æ€é“¾æ¥åˆ° C++ å¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“ï¼‰ã€‚</p>
<pre><code class="language-cargo">[lib]
name = &quot;rust&quot;
crate-type = [&quot;staticlib&quot;]
</code></pre>
<p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ CXX-Qt éœ€è¦ä»¥ä¸‹ä¾èµ–é¡¹ã€‚</p>
<pre><code class="language-cargo">[dependencies]
cxx = &quot;1.0&quot;
cxx-qt = { path = &quot;../../cxx-qt&quot; }
cxx-qt-lib = { path = &quot;../../cxx-qt-lib&quot; }
</code></pre>
<p>æœ€åï¼Œbuild.rs æ–‡ä»¶éœ€è¦ä»¥ä¸‹æ„å»ºä¾èµ–é¡¹æ‰èƒ½è¿è¡Œã€‚</p>
<pre><code class="language-cargo">[build-dependencies]
clang-format = &quot;0.1&quot;
cxx-qt-build = { path = &quot;../../cxx-qt-build&quot; }
</code></pre>
<p>æ³¨æ„ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ <a href="https://crates.io/">crates.io</a>ï¼Œåˆ™å¯¹äºä¾èµ–é¡¹ï¼Œåˆ™ä¸éœ€è¦ path å‚æ•°ï¼Œè€Œæ˜¯åƒå¾€å¸¸ä¸€æ ·å†™ä¸Šç‰ˆæœ¬å·å³å¯ï¼ˆä¾‹å¦‚ <code>cxx-qt = &quot;0.3&quot;</code>ï¼‰ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="cmake"><a class="header" href="#cmake">CMake</a></h1>
<p>æˆ‘ä»¬éœ€è¦æ·»åŠ  CMake æ¥ç”Ÿæˆ C++ ä»£ç ï¼Œç„¶åè¿›è¡Œé“¾æ¥ï¼Œåœ¨æ­¤è¦ç¡®ä¿ <code>CxxQt.cmake</code> å¯ä»¥è¢« CMake æ‰¾åˆ°ã€‚ä¸ºæ­¤ï¼Œå¿…é¡»è°ƒæ•´<a href="https://cmake.org/cmake/help/latest/variable/CMAKE_MODULE_PATH.html"><code>CMAKE_MODULE_PATH</code> CMake å˜é‡</a>ä»¥åŒ…å« CXX-Qt ä»£ç åº“ä¸­çš„ <code>cmake</code> ç›®å½•ã€‚</p>
<p>å®ç°è¿™ä¸€æ­¥éª¤çš„æ–¹æ³•åŒ…æ‹¬ï¼š</p>
<ul>
<li>åœ¨è°ƒç”¨ CMake æ—¶æä¾› <code>-DCMAKE_MODULE_PATH=&lt;path-to-cxx-qt-repo&gt;/cmake</code> é€‰é¡¹ã€‚</li>
<li>æ·»åŠ  <code>list(APPEND CMAKE_MODULE_PATH &quot;${CMAKE_CURRENT_LIST_DIR}/../cxx-qt/cmake&quot;)</code> åˆ° CXX-Qt ä»£ç åº“çš„ç›¸å¯¹è·¯å¾„ã€‚
<ul>
<li>å¦‚æœå°† CXX-Qt ä½œä¸º git å­æ¨¡å—æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œæ­¤é€‰é¡¹ç‰¹åˆ«æœ‰ç”¨ã€‚</li>
</ul>
</li>
<li>ä½¿ç”¨ CMake GUI æ›´æ”¹å˜é‡</li>
</ul>
<p>ç„¶åæˆ‘ä»¬åœ¨ CMake ä¸­æœ‰å¤šä¸ªé˜¶æ®µè¦æ‰§è¡Œ</p>
<ul>
<li><code>cxx_qt_generate_cpp</code>
<ul>
<li>ç„¶åæˆ‘ä»¬åœ¨ CMake ä¸­æœ‰å¤šä¸ªé˜¶æ®µè¦æ‰§è¡Œ</li>
<li>è§£æRust é¡¹ç›®ï¼Œä»¥ç”Ÿæˆç›¸å…³ C++ ä»£ç </li>
<li>å°†æºä»£ç æ·»åŠ åˆ° <code>GEN_SOURCES</code></li>
</ul>
</li>
<li><code>add_executable</code>
<ul>
<li>å°†ç”Ÿæˆçš„ C++ æºä»£ç æ·»åŠ åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå’Œåœ¨æ™®é€š C++ é¡¹ç›®ä¸­ä¸€æ ·</li>
</ul>
</li>
<li><code>cxx_qt_include</code>
<ul>
<li>æ·»åŠ ä»»ä½•éœ€è¦çš„ CXX-Qt å’Œ CXX çš„é™æ€æºåˆ°åŒ…å«ç›®å½•ä¸­</li>
</ul>
</li>
<li><code>cxx_qt_link_rustlib</code>
<ul>
<li>å°†é™æ€ Rust åº“é“¾æ¥åˆ° C++ ç›®æ ‡</li>
</ul>
</li>
</ul>
<pre><code class="language-cmake ignore">include(CxxQt)

# Generate C++ code from Rust using Cargo in the current folder
cxx_qt_generate_cpp(GEN_SOURCES)

# Define our sources
set(
    CPP_SOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/src/main.cpp
)

set(
    RESOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/src/qml.qrc
)

# Define our executable with our C++ source, generated sources, and QML resource files
add_executable(${APP_NAME} &quot;${CPP_SOURCES}&quot; &quot;${GEN_SOURCES}&quot; &quot;${RESOURCES}&quot;)

# Include generated sources
cxx_qt_include(${APP_NAME})

# Link to generated rust library
cxx_qt_link_rustlib(${APP_NAME})

# Link to Qt in the normal way
target_link_libraries(${APP_NAME} PRIVATE
    Qt${QT_VERSION_MAJOR}::Core
    Qt${QT_VERSION_MAJOR}::Gui
    Qt${QT_VERSION_MAJOR}::Qml
    Qt${QT_VERSION_MAJOR}::QuickControls2
)
qt_import_qml_plugins(${APP_NAME})
</code></pre>
<p>æ„å»ºæ’ä»¶æ—¶ï¼Œè¯·å‚é˜… <a href="concepts/./qqmlextensionplugin.html">QQmlExtensionPlugin é¡µé¢</a>äº†è§£ CMake çš„å·®å¼‚ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2021 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="c-æ³¨å†Œ-qml-ç±»å‹"><a class="header" href="#c-æ³¨å†Œ-qml-ç±»å‹">C++ æ³¨å†Œ QML ç±»å‹</a></h1>
<p>æ³¨å†Œç”Ÿæˆçš„ QML ç±»å‹æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œä½œä¸º <a href="concepts/./qqmlextensionplugin.html">QQmlExtensionPlugin</a>ä½¿ç”¨æˆ–å°†ç±»å‹æ³¨å†Œåˆ°å¼•æ“ã€‚</p>
<h2 id="æ³¨å†Œåˆ°å¼•æ“"><a class="header" href="#æ³¨å†Œåˆ°å¼•æ“">æ³¨å†Œåˆ°å¼•æ“</a></h2>
<p>å¦‚æœè¦å°†ç±»å‹æ³¨å†Œåˆ°å¼•æ“ï¼Œé¦–å…ˆåŒ…å«ç”Ÿæˆçš„å¯¹è±¡ï¼ˆç”± Rust æ¨¡å—çš„åç§°ç¡®å®šï¼‰ã€‚</p>
<pre><code class="language-cpp ignore">#include &quot;cxx-qt-gen/include/my_object.h&quot;
</code></pre>
<p>ç„¶åä»¥æ­£å¸¸æ–¹å¼æ³¨å†Œ QML ç±»å‹ã€‚</p>
<pre><code class="language-cpp ignore">  qmlRegisterType&lt;cxx_qt::my_object::MyObject&gt;(
    &quot;com.kdab.cxx_qt.demo&quot;, 1, 0, &quot;MyObject&quot;);
</code></pre>
<p>æ³¨æ„ï¼Œå°†æ¥å¯èƒ½ä¼šæœ‰ä¸€ä¸ª helper è°ƒç”¨ï¼Œå³ä½¿ä¸ä½¿ç”¨æ’ä»¶ä¹Ÿå¯ä»¥æ³¨å†Œæ‰€æœ‰ç±»å‹( <a href="https://github.com/KDAB/cxx-qt/issues/33">https://github.com/KDAB/cxx-qt/issues/33</a> )ã€‚</p>
<h2 id="ä½¿ç”¨-qqmlextensionplugin"><a class="header" href="#ä½¿ç”¨-qqmlextensionplugin">ä½¿ç”¨ QQmlExtensionPlugin</a></h2>
<p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ QQmlExtensionPluginï¼Œè¯·ç¡®ä¿ç”Ÿæˆçš„åº“ä½äºå¯¼å…¥è·¯å¾„ä¸­ã€‚</p>
<pre><code class="language-cpp ignore">  QQmlApplicationEngine engine;
  // Add qml dir in runtime folder to QML import paths
  engine.addImportPath(QDir(QCoreApplication::applicationDirPath())
                         .filePath(QStringLiteral(&quot;qml&quot;)));
</code></pre>
<h2 id="qml"><a class="header" href="#qml">QML</a></h2>
<p>ä¸€æ—¦æ‚¨ä½¿ç”¨äº†ä¸Šè¿°ä»»ä½•ä¸€ç§æ–¹æ³•å°†ç±»å‹æ³¨å†Œåˆ°å¼•æ“ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä» QML ä¸­åƒæ™®é€šçš„ C++ æ¨¡å—ä¸€æ ·åŒ…å«è¿™äº›ç±»å‹ã€‚</p>
<pre><code class="language-qml ignore">import com.kdab.cxx_qt.demo 1.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="qqmlextensionplugin"><a class="header" href="#qqmlextensionplugin">QQmlExtensionPlugin</a></h1>
<p>Qt å…è®¸åœ¨è¿è¡Œæ—¶ä»ç›®å½•åŠ è½½åŒ…å«å¯¹è±¡å®šä¹‰çš„æ’ä»¶ï¼Œè€Œä¸æ˜¯åµŒå…¥åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</p>
<p>è¿™å…è®¸åœ¨ä¸šåŠ¡é€»è¾‘å’Œ GUI ä»£ç çš„å­¦ç§‘ä¹‹é—´è¿›è¡Œæ¸…æ™°çš„åˆ’åˆ†ã€‚</p>
<p>CXX-Qt å¯ä»¥ç”Ÿæˆæ’ä»¶å’Œ qmldir æ–‡ä»¶ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å°† Rust å¯¹è±¡ä½œä¸ºæ’ä»¶åŠ è½½åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ã€‚</p>
<p>ä½¿ç”¨ QQmlExtensionPlugin æ—¶ï¼Œæ‚¨çš„é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æ„å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥çœ‹åˆ°â€œcoreâ€å’Œâ€œuiâ€ä¹‹é—´çš„æ¸…æ™°åˆ’åˆ†</p>
<pre><code class="language-ignore">src/
 - core/
   - build.rs
   - Cargo.toml
   - CMakeLists.txt
   - src/
     - lib.rs
 - ui/
   - main.qml
   - qml.qrc
 CMakeLists.txt
 main.cpp
</code></pre>
<h2 id="rust-buildrs-çš„æ›´æ”¹"><a class="header" href="#rust-buildrs-çš„æ›´æ”¹">Rust build.rs çš„æ›´æ”¹</a></h2>
<p>åœ¨æ‚¨ <code>build.rs</code> æŒ‡å®šè¦é€šè¿‡è°ƒç”¨ <code>qqmlextensionplugin</code> æ–¹å¼æ¥ä½¿ç”¨ QQmlExtensionPluginï¼Œå¦‚ä¸‹ä¾‹å­ä¸­æ‰€ç¤ºã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæ‚¨å†™ä¸Š QML çš„å¯¼å…¥åç§°å’Œæ‚¨ç”¨äºç”Ÿæˆçš„æ’ä»¶ç›®æ ‡çš„åç§°ã€‚</p>
<pre><code class="language-rust ignore noplayground">use clang_format::ClangFormatStyle;
use cxx_qt_build::CxxQtBuilder;

fn main() {
    CxxQtBuilder::new()
        .qqmlextensionplugin(
            &quot;com.kdab.cxx_qt.demo&quot;, // QML import name
            &quot;core_qmlplugin&quot;,       // C++ library target name
        )
        .cpp_format(ClangFormatStyle::Mozilla)
        .file(&quot;src/lib.rs&quot;)
        .build();
}
</code></pre>
<h2 id="cmake-çš„æ›´æ”¹"><a class="header" href="#cmake-çš„æ›´æ”¹">CMake çš„æ›´æ”¹</a></h2>
<p>ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†ç”¨äºæ„å»ºæ‰©å±•æ’ä»¶çš„ CMake å®šä¹‰ã€‚
The following example shows the CMake definition for building an extension plugin.</p>
<p>æ³¨æ„ï¼Œæ–‡ä»¶å¤¹ç»“æ„å¿…é¡»ä¸ QML å¯¼å…¥åç§°åŒ¹é…ï¼Œå¦‚ <code>import foo.bar 1.0</code> æ„å‘³ç€ <code>foo/bar</code> æ–‡ä»¶å¤¹éœ€è¦åŒ…å«æ’ä»¶å’Œ qmldir æ–‡ä»¶ã€‚</p>
<pre><code class="language-cmake ignore">include(CxxQt)

set(QML_IMPORT_DIR ${CMAKE_CURRENT_BINARY_DIR}/../qml)
# TODO: generate this path and name from the build.rs then our cmake helpers can read this from .txt
set(PLUGIN_OUTPUT_DIR ${QML_IMPORT_DIR}/com/kdab/cxx_qt/demo)

# Generate C++ code from Rust using Cargo in the current folder
cxx_qt_generate_cpp(GEN_SOURCES)

# Define our QML plugin library
add_library(core_qmlplugin SHARED &quot;${GEN_SOURCES}&quot;)
# Set directory for our library
set_target_properties(core_qmlplugin PROPERTIES
    LIBRARY_OUTPUT_DIRECTORY ${PLUGIN_OUTPUT_DIR}
)

# Include generated sources
cxx_qt_include(core_qmlplugin)
# Link to generated rust library
cxx_qt_link_rustlib(core_qmlplugin)
# Link to Qt libraries
target_link_libraries(core_qmlplugin PRIVATE
    Qt${QT_VERSION_MAJOR}::Core
    Qt${QT_VERSION_MAJOR}::Gui
    Qt${QT_VERSION_MAJOR}::Qml
    Qt${QT_VERSION_MAJOR}::QuickControls2
)

# Install the qmldir file into the plugin folder
configure_file(${CMAKE_CURRENT_SOURCE_DIR}/target/cxx-qt-gen/plugin/qmldir ${PLUGIN_OUTPUT_DIR}/qmldir COPYONLY)
</code></pre>
<h2 id="qt-c-çš„æ”¹å˜"><a class="header" href="#qt-c-çš„æ”¹å˜">Qt C++ çš„æ”¹å˜</a></h2>
<p>è¦åœ¨è¿è¡Œæ—¶åŠ è½½æ’ä»¶ï¼Œè¯·å°†åŒ…å«æ’ä»¶çš„ç›®å½•æ·»åŠ åˆ° QML å¯¼å…¥è·¯å¾„ä¸­ã€‚</p>
<pre><code class="language-cpp ignore">  QQmlApplicationEngine engine;
  // Add qml dir in runtime folder to QML import paths
  engine.addImportPath(QDir(QCoreApplication::applicationDirPath())
                         .filePath(QStringLiteral(&quot;qml&quot;)));
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="çº¿ç¨‹-1"><a class="header" href="#çº¿ç¨‹-1">çº¿ç¨‹</a></h1>
<h2 id="æ¦‚å¿µ-1"><a class="header" href="#æ¦‚å¿µ-1">æ¦‚å¿µ</a></h2>
<p>çº¿ç¨‹çš„ä¸€èˆ¬æ¦‚å¿µæ˜¯ï¼Œå½“æ‰§è¡Œ Rust ä»£ç æ—¶ï¼Œåœ¨ C++ ç«¯è·å–äº†ä¸€ä¸ªé”ï¼Œä»¥é˜²æ­¢ä»å¤šä¸ªçº¿ç¨‹æ‰§è¡Œ Rust ä»£ç ã€‚</p>
<p>è¿™æ„å‘³ç€ç›´æ¥ä» C++ è°ƒç”¨çš„ Rust ä»£ç ï¼ˆä¾‹å¦‚å¯è°ƒç”¨å‡½æ•°å’Œ handlersï¼‰åœ¨ Qt çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚</p>
<p>æˆ‘ä»¬æä¾›äº†ä¸€ç§è§£å†³æ–¹æ¡ˆæ¥é˜²æ­¢ä»ä¿¡å·è¿æ¥è¿›å…¥æ­»é”ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå±æ€§æ›´æ”¹ä¿¡å·è¿æ¥åˆ° C++/QML ç«¯çš„å¯è°ƒç”¨å‡½æ•°ï¼Œå¦‚æœå±æ€§æ›´æ”¹æ˜¯ä» Rust å¯è°ƒç”¨å¯¹è±¡è§¦å‘çš„ï¼Œåˆ™å°†æ— æ³•è·å–é”ã€‚è§£å†³æ–¹æ¡ˆæ˜¯å°†å¯èƒ½å¯¼è‡´æ­»é”çš„äº‹ä»¶å‘å¸ƒåˆ°é˜Ÿåˆ—ä¸­ï¼Œä¾‹å¦‚ä¿¡å·è§¦å‘ï¼Œç„¶ååœ¨ Rust å¯è°ƒç”¨å‡½æ•°çš„é”è¢«é‡Šæ”¾ä¹‹åï¼Œåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯å‘ç”Ÿæ—¶æ‰§è¡Œè¿™äº›äº‹ä»¶ã€‚</p>
<p>å¦‚æœ Rust ä»£ç éœ€è¦ç›‘å¬å±æ€§å˜åŒ–ï¼Œå¯ä»¥åœ¨ <a href="concepts/../qobject/handlers.html">RustObj Handlers</a> ä¸­å®ç° handlersï¼ˆä¾‹å¦‚ PropertyChangeHandlerï¼‰ã€‚è¿™æ˜¯ç›´æ¥åœ¨ Qt çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯ä¸­è°ƒç”¨çš„ã€‚</p>
<div style="background-color: white; padding: 1rem; text-align: center;">
<p><img src="concepts/../images/threading_abstract.svg" alt="Threading Abstract" /></p>
</div>
<h2 id="å¤šçº¿ç¨‹"><a class="header" href="#å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</a></h2>
<p>ä¸ºäº†åœ¨ Rust ç«¯å®â€‹â€‹ç°å®‰å…¨çš„å¤šçº¿ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>UpdateRequester</code>. Rust çº¿â€‹â€‹ç¨‹åœ¨å“ªé‡Œå¯åŠ¨ï¼ˆä¾‹å¦‚ä¸€ä¸ªå¯è°ƒç”¨å‡½æ•°ï¼‰<code>UpdateRequester</code> å°±åº”è¯¥è¢«å…‹éš†åˆ°è¯¥çº¿ç¨‹ä¸­ã€‚</p>
<p>ç„¶åï¼Œå½“åç«¯çº¿ç¨‹éœ€è¦æ›´æ–° Qt å¯¹è±¡ä¸­çš„å€¼æ—¶ï¼Œå®ƒä¼šè¯·æ±‚æ›´æ–°ï¼Œè¿™å°†è¢«å‘å¸ƒåˆ°ä¸ä¸Šé¢ç›¸åŒçš„é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦äº‹ä»¶å¾ªç¯å‘ç”Ÿï¼Œå°±ä¼šåœ¨ <a href="concepts/../qobject/handlers.html">RustObj handlers</a> ä¸­è°ƒç”¨ <code>UpdateRequestHandler</code>ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥å®‰å…¨åœ°è°ƒç”¨ setter æˆ–ä» Qt çº¿ç¨‹å‘å‡ºä¿¡å·å¹¶å°†æ‚¨çš„çŠ¶æ€åŒæ­¥åˆ°å‰ç«¯ã€‚</p>
<p>æˆ‘ä»¬å»ºè®®ä½¿ç”¨çº¿ç¨‹ä¸­çš„é€šé“æ¥å‘é€ä¿¡å·æšä¸¾ï¼Œæˆ–è€…å‘é€åœ¨ä¹‹åå¤„ç†çš„ <code>UpdateRequestHandler</code> çš„å€¼.</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Rust å¤šçº¿ç¨‹å¯¹è±¡ç¤ºä¾‹ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod website {
    use futures::{
        channel::mpsc::{UnboundedReceiver, UnboundedSender},
        executor::block_on,
        FutureExt, StreamExt,
    };
    use futures_timer::Delay;
    use std::{
        sync::atomic::{AtomicBool, Ordering},
        thread,
        time::Duration,
    };

    enum Event {
        TitleArrived(String),
    }

    pub struct Data {
        url: String,
        title: String,
    }

    impl Default for Data {
        fn default() -&gt; Self {
            Self {
                url: &quot;known&quot;.to_owned(),
                title: &quot;Press refresh to get a title...&quot;.to_owned(),
            }
        }
    }

    struct RustObj {
        event_sender: UnboundedSender&lt;Event&gt;,
        event_queue: UnboundedReceiver&lt;Event&gt;,
        loading: AtomicBool,
    }

    impl Default for RustObj {
        fn default() -&gt; Self {
            let (event_sender, event_queue) = futures::channel::mpsc::unbounded();

            Self {
                event_sender,
                event_queue,
                loading: AtomicBool::new(false),
            }
        }
    }

    impl RustObj {
        #[invokable]
        fn change_url(&amp;self, cpp: &amp;mut CppObj) {
            let url = cpp.url();
            let new_url = if url == &quot;known&quot; { &quot;unknown&quot; } else { &quot;known&quot; };
            cpp.set_url(new_url);
        }

        #[invokable]
        fn refresh_title(&amp;self, cpp: &amp;mut CppObj) {
            // TODO: SeqCst is probably not the most efficient solution
            let new_load =
                self.loading
                    .compare_exchange(false, true, Ordering::SeqCst, Ordering::SeqCst);
            if new_load.is_err() {
                println!(&quot;Skipped refresh_title request, because already in progress.&quot;);
                return;
            }

            cpp.set_title(&quot;Loading...&quot;);

            let url = cpp.url();
            // Retrieve the update requester from the CppObj
            let update_requester = cpp.update_requester();
            let event_sender = self.event_sender.clone();

            let fetch_title = async move {
                // Simulate the delay of a network request with a simple timer
                Delay::new(Duration::from_secs(1)).await;

                let title = if url == &quot;known&quot; {
                    &quot;Known website&quot;
                } else {
                    &quot;Unknown website&quot;
                };

                event_sender
                    .unbounded_send(Event::TitleArrived(title.to_owned()))
                    .unwrap();
                // Request an update from the background thread
                update_requester.request_update();
            };
            thread::spawn(move || block_on(fetch_title));
        }

        fn process_event(&amp;mut self, event: &amp;Event, cpp: &amp;mut CppObj) {
            match event {
                Event::TitleArrived(title) =&gt; {
                    cpp.set_title(title);
                    self.loading.store(false, Ordering::Relaxed);
                }
            }
        }
    }

    impl UpdateRequestHandler&lt;CppObj&lt;'_&gt;&gt; for RustObj {
        fn handle_update_request(&amp;mut self, cpp: &amp;mut CppObj) {
            while let Some(event) = self.event_queue.next().now_or_never() {
                if let Some(event) = event {
                    self.process_event(&amp;event, cpp);
                }
            }
        }
    }

    impl PropertyChangeHandler&lt;CppObj&lt;'_&gt;, Property&gt; for RustObj {
        fn handle_property_change(&amp;mut self, cpp: &amp;mut CppObj, property: Property) {
            match property {
                Property::Url =&gt; self.refresh_title(cpp),
                Property::Title =&gt; println!(&quot;title changed&quot;),
                _ =&gt; unreachable!(),
            }
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="åµŒå¥—å¯¹è±¡"><a class="header" href="#åµŒå¥—å¯¹è±¡">åµŒå¥—å¯¹è±¡</a></h1>
<p>Rust Qt å¯¹è±¡å¯ä»¥ä½œä¸ºå½¼æ­¤çš„å±æ€§æˆ–å‚æ•°åµŒå¥—ã€‚</p>
<p>åµŒå¥—å¯¹è±¡ç”±å®ƒçš„ <code>crate</code> ç›¸å¯¹è·¯å¾„å¼•ç”¨ï¼Œç„¶å <code>CppObj</code> ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ã€‚å¦‚ <code>crate::mymod::secondary_object::CppObj</code> æŒ‡çš„æ˜¯ä¸€ä¸ª <code>mymod.rs</code> åŒ…å«å¸¦æœ‰ <a href="concepts/../qobject/macro.html">CXX-Qt å®</a>çš„ <code>secondary_object</code> çš„æ¨¡å—ã€‚</p>
<p>è¦å°†å…¶ç”¨ä½œä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œè¯·ä»¥ <code>secondary_object: crate::mymod::secondary_object::CppObj</code> ä½œä¸ºå±æ€§ã€‚</p>
<p>ç”¨ä½œå¯è°ƒå‡½æ•°ç”¨å‚æ•°æ—¶ï¼Œè¯·ä»¥ <code>secondary_object: &amp;mut crate::mymod::secondary_object::CppObj</code> ä½œä¸ºå‚æ•°ã€‚ç„¶åå¯ä»¥é€šè¿‡å¸¸è§„ <code>CppObj</code> æ–¹æ³•ä½¿ç”¨è¯¥å‚æ•° <code>secondary_object</code>ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå°†åµŒå¥—å¯¹è±¡æ˜¾ç¤ºä¸ºå±æ€§å’Œå‚æ•°çš„ç¤ºä¾‹ã€‚</p>
<pre><code class="language-rust ignore noplayground">#[make_qobject]
mod nested {
    #[derive(Default)]
    pub struct Data {
        nested: crate::rust_obj_invokables::rust_obj_invokables::CppObj,
    }

    #[derive(Default)]
    struct RustObj;

    impl RustObj {
        #[invokable]
        fn nested_parameter(
            &amp;self,
            nested: &amp;mut crate::rust_obj_invokables::rust_obj_invokables::CppObj,
        ) {
            println!(&quot;Number: {}&quot;, nested.number());
            // TODO: we can't reach the nested object's RustObj yet
            // for this we will need `nested.borrow_rust_obj()` later
            // https://github.com/KDAB/cxx-qt/issues/30
        }

        #[invokable]
        fn nested_take_give(&amp;self, cpp: &amp;mut CppObj) {
            // We now own the nested object and QML would be null
            //
            // TODO: should this return a OwnedCppObj which derefs to the CppObj ?
            // (so that we don't need to do the CppObj::new(obj))
            // and holds the UniquePtr internally so that OwnedCppObj can be moved back in the give ?
            // https://github.com/KDAB/cxx-qt/issues/30
            let mut nested = cpp.take_nested();

            crate::rust_obj_invokables::rust_obj_invokables::CppObj::new(nested.pin_mut())
                .set_number(10);

            // The nested object is now back in QML
            cpp.give_nested(nested);
        }
    }
}
</code></pre>
<p>æ³¨æ„ï¼šåµŒå¥—å¯¹è±¡è¿˜ä¸èƒ½ç”¨ä½œè¿”å›ç±»å‹( <a href="https://github.com/KDAB/cxx-qt/issues/66">https://github.com/KDAB/cxx-qt/issues/66</a> )ã€‚</p>
<p>æ³¨æ„ï¼šåµŒå¥—å¯¹è±¡åœ¨ï¼ˆåï¼‰åºåˆ—åŒ–ä¸­ä¼šè¢«å¿½ç•¥ ( <a href="https://github.com/KDAB/cxx-qt/issues/35">https://github.com/KDAB/cxx-qt/issues/35</a> )ã€‚</p>
<p>æ³¨æ„ï¼šåµŒå¥—å¯¹è±¡ä¸èƒ½åœ¨ä¿¡å·ä¸­ä½¿ç”¨ ( <a href="https://github.com/KDAB/cxx-qt/issues/73">https://github.com/KDAB/cxx-qt/issues/73</a> )ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨æœªæ¥å¯èƒ½å…è®¸ä½¿ç”¨ <code>super::</code> ( <a href="https://github.com/KDAB/cxx-qt/issues/44">https://github.com/KDAB/cxx-qt/issues/44</a> )ã€‚</p>
<p>TODO: ä¸€æ—¦æˆ‘ä»¬æœ‰äº† borrow_rust_obj() ï¼Œè¯·è¯´æ˜å®ƒè®¿é—®å…¶ä»–å¯¹è±¡ RustObj çš„ç›®çš„ <a href="https://github.com/KDAB/cxx-qt/issues/30">https://github.com/KDAB/cxx-qt/issues/30</a> )ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="internal"><a class="header" href="#internal">Internal</a></h1>
<p>ä¸ CXX-Qt é¡¹ç›®å‰–æç›¸å…³çš„æ–‡æ¡£ã€‚</p>
<ul>
<li><a href="internal/./build.html">æ„å»ºè¿‡ç¨‹æ˜¯å¦‚ä½•å·¥ä½œ</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--
SPDX-FileCopyrightText: 2022 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Andrew Hayzen <andrew.hayzen@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="æ„å»º"><a class="header" href="#æ„å»º">æ„å»º</a></h1>
<p>åœ¨å†…éƒ¨æ„å»º CXX-Qt é¡¹ç›®çš„è¿‡ç¨‹å¾ˆå¤æ‚ï¼ŒåŒ…å«å¤šä¸ªé˜¶æ®µã€‚</p>
<ol>
<li>CMake build å¼€å§‹ï¼Œå¹¶è§¦å‘ cargo build</li>
<li>CXX-Qt æ„å»ºç”Ÿæˆ C++ æºç å’Œé™æ€åº“</li>
<li>CMake ç»“åˆç”Ÿæˆçš„æºç æ„å»ºé¡¹ç›® C++ æº</li>
<li>CMake å°†ç›®æ ‡é“¾æ¥åˆ° Rust é™æ€åº“å’Œ Qt</li>
</ol>
<h2 id="1-cargo-æ„å»º"><a class="header" href="#1-cargo-æ„å»º">1. Cargo æ„å»º</a></h2>
<p>å½“ cargo build è¢«è§¦å‘æ—¶ï¼Œè¿™ä¼šå¯¼è‡´ä¾èµ–é¡¹è¢«ä¸‹è½½å’Œæ„å»ºã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯ <code>cxx-qt-lib</code> å®šä¹‰çš„ Qt è¾…åŠ©ç±»å‹ã€‚å®ƒåŒ…å«ä¸€ä¸ª <code>build.rs</code>ï¼Œå…¶ä½¿ç”¨ CXX ç”Ÿæˆ Qt ç±»å‹çš„ C++ æºä»£ç ã€‚è¿™ä¼šå­˜å‚¨æˆä¸€ä¸ªåœ¨ crate OUT_DIR ç›®å½•ä¸‹çš„ JSON æ–‡ä»¶ä¸­ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬æ— æ³•ä»ä¸»é¡¹ç›®ä¸­çŸ¥é“è¿™äº› <code>OUT_DIR</code> æ–‡ä»¶æˆ–å…¶ä»– <code>cxx-qt-lib</code> æ–‡ä»¶åœ¨å“ªé‡Œï¼Œå› ä¸ºå®ƒä»¬ä½äºæ•£åˆ—ç›®å½•ä¸­ã€‚å› æ­¤ï¼Œ<code>cxx-qt-lib</code> åœ¨æ„å»ºæ—¶ï¼Œå®ƒä½¿ç”¨ <code>include_str!</code> å°†ç”Ÿæˆçš„ JSON å…¬å¼€åˆ° <code>QT_TYPES_CXX_JSON</code> å˜é‡ä¸­ã€‚</p>
<p>ä¸‹ä¸€æ­¥ cargo è§¦å‘ build.rs ä¸»é¡¹ç›®ï¼Œå®ƒæ‰§è¡Œ <code>cxx-qt-build</code> è¾…åŠ©æ–¹æ³•ã€‚</p>
<h2 id="2-cxx-qt-æ„å»º"><a class="header" href="#2-cxx-qt-æ„å»º">2. CXX-Qt æ„å»º</a></h2>
<p>é¦–å…ˆ <code>cxx-qt-build</code> ä½¿ç”¨ CXX ä¸ºé¡¹ç›®çš„ Rust æºæ–‡ä»¶ç”Ÿæˆ C++ æºæ–‡ä»¶åˆ°ä¸€ä¸ªå·²çŸ¥çš„ä½ç½® CMake (<code>target/cxx-qt-gen/</code>)ã€‚</p>
<p>ç„¶å <code>cxx-qt-build</code> å°†æ‰€æœ‰é™æ€å¤´æ–‡ä»¶ï¼ˆä¾‹å¦‚ CXX å¤´æ–‡ä»¶ï¼‰å’Œ <code>QQmlExtensionPlugin</code> ç”Ÿæˆçš„ä»£ç å†™å…¥åŒä¸€ä¸ªç›®å½•ä¸­ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå®ƒåœ¨ <code>cxx-qt-lib</code> ä¸­ä½¿ç”¨å­—ç¬¦ä¸² <code>QT_TYPES_HEADER</code>ã€<code>QT_TYPES_SOURCE</code> å’Œ <code>QT_TYPES_CXX_JSON</code>ï¼ˆä»£è¡¨å¤šä¸ªæ–‡ä»¶ï¼‰å°† C++ æºæ–‡ä»¶å†™å…¥ CMake ( target/cxx-qt-lib/) çš„å·²çŸ¥ä½ç½® CMake (<code>target/cxx-qt-lib/</code>)ä¸­ã€‚</p>
<p>æœ€åï¼Œå®ƒå°†ç”Ÿæˆçš„ C++ æºåˆ—è¡¨å†™å…¥ <code>cxx-qt-gen</code> æ–‡ä»¶å¤¹ä¸­çš„ <code>cpp_sources.txt</code> æ–‡ä»¶ã€‚</p>
<p>Cargo ç°åœ¨ç»§ç»­æ­£å¸¸æ„å»º Rust é¡¹ç›®ï¼Œæ‰©å±•å®å¹¶åˆ›å»ºé™æ€åº“ã€‚</p>
<h2 id="3-cmake-æ„å»º"><a class="header" href="#3-cmake-æ„å»º">3. CMake æ„å»º</a></h2>
<p>ç°åœ¨ Rust å·²ç»å®Œæˆæ„å»ºï¼ŒCMake è¯»å–ç”Ÿæˆçš„ C++ æºå¹¶å°†å®ƒä»¬ä¸é¡¹ç›® C++ æºèåˆï¼ˆåœ¨æ­¤é˜¶æ®µè¿˜æ·»åŠ äº† QML èµ„æºï¼‰ã€‚</p>
<p>è¿™ä¼šåœ¨ CMake ä¸­ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œç›®æ ‡ã€‚</p>
<h2 id="4-cmake-é“¾æ¥"><a class="header" href="#4-cmake-é“¾æ¥">4. CMake é“¾æ¥</a></h2>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯æ‰§è¡Œçš„ç›®æ ‡ï¼Œæˆ‘ä»¬é¦–å…ˆå°†ç›®æ ‡ä» cargo é“¾æ¥åˆ° Rust é™æ€åº“ã€‚ç„¶åæˆ‘ä»¬é“¾æ¥ä»»ä½•å¤–éƒ¨åº“ï¼Œä¾‹å¦‚çº¿ç¨‹åº“ï¼Œæœ€åé“¾æ¥åˆ° Qtã€‚</p>
<p>è¿™å°†å¯¼è‡´ CMake ç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯¥äºŒè¿›åˆ¶æ–‡ä»¶å°† Rust ä¸ C++ åº”ç”¨ç¨‹åºç»“åˆåœ¨ä¸€èµ·ã€‚</p>
<h2 id="æœªæ¥"><a class="header" href="#æœªæ¥">æœªæ¥</a></h2>
<p>å°†æ¥ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹ CMake æ„å»ºè¿‡ç¨‹è¿›è¡Œå¤šé¡¹æ”¹è¿›ã€‚</p>
<ul>
<li>å°† CXX ç”Ÿæˆå’Œ Rust æ„å»ºæ‹†åˆ†ä¸ºå•ç‹¬çš„é˜¶æ®µã€‚ç›®å‰ CMake çš„é…ç½®é˜¶æ®µä¼šå¯¼è‡´ Rust æ„å»ºã€‚æœ€å¥½åˆ›å»ºä¸€ä¸ª CLI å·¥å…·ï¼Œå®ƒåªæ˜¯ä¸ºç»™å®šçš„ Rust æºç”Ÿæˆ C++ æºå¹¶å°†å®ƒä»¬å†™å…¥ç»™å®šçš„ä½ç½®ã€‚ç„¶åè¿™å¯ä»¥ç”¨äºç”Ÿæˆ C++ æºä»£ç ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç¨åçš„ CMake æ„å»ºé˜¶æ®µæ­£å¸¸ä½¿ç”¨ cargo build <a href="https://github.com/KDAB/cxx-qt/issues/106">https://github.com/KDAB/cxx-qt/issues/106</a>
<ul>
<li>CMake å¦‚ä½•çŸ¥é“è¦è§£æå“ªäº› Rust æ–‡ä»¶ï¼Ÿå¦‚æœæˆ‘ä»¬å¯ä»¥å°†å®ƒæŒ‡å‘ä¸€ä¸ªæ¸…å•å¹¶ä¸”å®ƒå¯ä»¥æ£€æµ‹åˆ° Rust æºæ–‡ä»¶ï¼Œé‚£å°†æ˜¯æœ€å¥½çš„ã€‚</li>
<li>è¯¥è¿‡ç¨‹çš„å“ªä¸ªé˜¶æ®µå°†å†™å…¥ <code>cxx-qt-lib</code> æ–‡ä»¶ï¼Ÿ</li>
</ul>
</li>
<li>æ£€æµ‹å“ªäº›åº“éœ€è¦ä»ä¾èµ– crate é“¾æ¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ Rust æ’ä»¶ä½¿ç”¨å¸¦æœ‰ sqlite å®ç°çš„ dieselï¼Œæ‚¨éœ€è¦æœ€ç»ˆçš„ CMake ç›®æ ‡é“¾æ¥åˆ°<a href="https://github.com/KDAB/cxx-qt/issues/29">https://github.com/KDAB/cxx-qt/issues/29</a></li>
<li>é¿å… C++ ä¸­çš„å‘½ååŒ…å«å†²çª<a href="https://github.com/KDAB/cxx-qt/issues/19">https://github.com/KDAB/cxx-qt/issues/18</a></li>
<li>è€ƒè™‘æˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡ä¸ Cargo å·¥ä½œç©ºé—´ä¸€èµ·ä½¿ç”¨çš„æ–¹å¼å…¬å¼€ç”Ÿæˆçš„æºã€‚ç›®å‰å¤šé¡¹ç›®ä¼šä¸ <code>target/cxx-qt-*</code> å‘ç”Ÿå†²çªã€‚<a href="https://github.com/KDAB/cxx-qt/pull/84">https://github.com/KDAB/cxx-qt/pull/84</a></li>
</ul>
<h2 id="å›¾è¡¨"><a class="header" href="#å›¾è¡¨">å›¾è¡¨</a></h2>
<p>ä¸‹é¢æ˜¯å½“å‰å·¥ä½œæµç¨‹çš„æŠ½è±¡å›¾</p>
<div style="background-color: white; padding: 1rem; text-align: center;">
<p><img src="internal/../images/build_abstract.svg" alt="Threading Abstract" /></p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
